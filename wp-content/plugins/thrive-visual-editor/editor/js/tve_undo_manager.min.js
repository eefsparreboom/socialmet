var UndoManager=function(b){var f=[],c=-1,e=false,g,a=typeof b!=="undefined"?parseInt(b):100;function d(i,h){if(!i){return this}e=true;i[h]();e=false;return this}return{register:function(l,i,k,o,n,m,j,h){this.add({undo:function(){i.apply(l,k)},redo:function(){m.apply(n,j)}})},add:function(h){if(e){return this}f.splice(c+1,f.length-c);if(f.length>a-1){f.splice(0,1)}f.push(h);c=f.length-1;if(g){g()}return this},setCallback:function(h){g=h},undo:function(){var h=f[c];if(!h){return this}d(h,"undo");c-=1;if(g){g()}return this},redo:function(){var h=f[c+1];if(!h){return this}d(h,"redo");c+=1;if(g){g()}return this},clear:function(){var h=f.length;f=[];c=-1;if(g&&(h>0)){g()}},hasUndo:function(){return c!==-1},hasRedo:function(){return c<(f.length-1)},getCommands:function(){return f}}};