var TVE_Content_Builder=TVE_Content_Builder||{};TVE_Content_Builder.config=tve_path_params;TVE_Content_Builder.validator={validators:{required:function(a){return a.val()?true:"Required value"}},isValid:function(c){var b=true,a;jQuery(c).find(".tve_ctrl_validate").each(function(){a=TVE_Content_Builder.validator.validateElement(jQuery(this));b=b&&a});if(!b){tve_add_notification("Please correct the marked errors and try again.",true)}return b},validateElement:function(c){var f=c.attr("data-validators"),e=true,a;if(!f){return callback(true)}f=f.split(";");for(var b=0,d;d=f[b++];){if(!this.validators[d]){continue}a=this.validators[d](c);if(a!==true){c.addClass("tve_ctrl_error");c.attr("title",a);e=false}else{c.removeClass("tve_ctrl_error");c.removeAttr("title")}}return e},addRule:function(a,b){this.validators[a]=b}};editable_elements="p,h1,h2,h3,h4,h5,h6,address,pre,img,th,td,li,blockquote,.thrv_wrapper,.tve_ts_o span,span.tve_ts_copy-aut, .tve_ts_copy-aut span .tve_btnLink span, .tve_ct_title, .thrv_tw_qs_button span span, .tve_editable, span.tve_custom_font_size, .tve_ca .tve_btnLink > span";block_editing_elements=".tve_custom_html_placeholder, .tve_custom_html_placeholder *, .thrv_custom_html_shortcode *, .thrv_post_grid *, .tve_no_edit, .tve_more_tag, .table_placeholder, .table_placeholder *, .image_placeholder, .image_placeholder *, .borderless_placeholder, .borderless_placeholder *, .ui-datepicker-header *,.tve_wp_shortcode *, #tve_mce_holder *, .code_placeholder, .thrv_widget *";block_clear_focus=".edit_mode, .edit_mode:not(.tve_p_lb_control,.tve_lp_content,.tve_wrap_all) *, .tve_secondLayer, .tve_secondLayer *, .tve_lightbox_content, .tve_lightbox_content *, .ui-datepicker-header *, .media-modal *";var text_elements="p,h1,h2,h3,h4,h5,h6,span,li,blockquote,th:not(.tve_table_cell),td:not(.tve_table_cell),address,pre";text_elements_inline_only=".tve_cb_cnt h3, .tve_fg h1, .tve_fg h3, .tve_ca h3, .tve_ca h1, .tve_tS, .tve_grt h3, .tve_ts span, .tve_btnLink > span, .tve_ct_title, .thrv_tw_qs_button span span, .thrv_tw_quote p, span.tve_custom_font_size";text_element_no_formatting=".tve_no_edit";selection_loss_tags="font, b, i, u, span";elements_no_left_menu=".tve_gri .image_placeholder, .table_placeholder";left_menu_hover_items=".thrv_wrapper, .tve_faq, p:not(.tve_more_tag), h1, h2, h3, h4, h5, h6";right_menu_hover_items="p, h1, h2, h3, h4, h5, h6, address, pre, .thrv_wrapper, blockquote, .tve_clearfix li, .thrv_wrapper p, ol, ul:not(.tve_scT > ul, .thrv_bullets_shortcode ul), ol li, ul li, .tve_faq, .tve_table_cell, .tve_p_lb_control, .thrv_feature_grid .tve_gri > .tve_image";elements_with_no_menu_icons=".tve_table_cell, .thrv_tw_quote p, .tve_p_lb_control, .tve_editor_main_content, .tve_lp_content, .tve_no_icons";elements_without_delete_button=".thrv_toggle_shortcode h4, .thrv_testimonial_shortcode img, .tve_colm, .thrv_post_grid *, .thrv_custom_html_shortcode *, .tve_table_cell, .tve_rating_stars > span, .tve_rating_stars, .tve_wp_shortcode *, .thrv_widget *";contains_nested_elements=["UL","OL"];block_tags=["ADDRESS","BLOCKQUOTE","P","H1","H2","H3","H4","H5","H6","OL","UL","PRE"];window.last_colour_used="tve_red";window.tve_custom_colours=[];window.tve_custom_colours=tve_path_params.tve_colour_picker_colours;thrv_custom_classes=["edit_light","edit_dark","edit_mode","tve_image","alignleft","aligncenter","alignright"];tve_undoManager=new UndoManager(5);custom_html_placeholder_class="tve_custom_html_placeholder";custom_html_default_html='<div class="'+custom_html_placeholder_class+' code_placeholder"><a class="tve_click tve_green_button clearfix" id="lb_custom_html" data-ctrl="controls.lb_open"><i></i><span>Insert Custom HTML</span></a></div>';border_styles="tve_brdr_none tve_brdr_dotted tve_brdr_dashed tve_brdr_solid tve_brdr_double tve_brdr_groove tve_brdr_ridge tve_brdr_inset tve_brdr_outset";img_styles="img_style_dark_frame img_style_framed img_style_lifted_style1 img_style_lifted_style2 img_style_polaroid img_style_rounded_corners img_style_circle img_style_caption_overlay";thrv_custom_classes=thrv_custom_classes.concat(img_styles.split(" "));var last_mouse_down=null;var custom_font_classes="";jQuery.each(tve_path_params.custom_fonts,function(){custom_font_classes+=(custom_font_classes?" ":"")+this.font_class});if(!Array.prototype.indexOf){Array.prototype.indexOf=function(b,d){var c,a=(d)?d:0,e;if(!this){throw new TypeError()}e=this.length;if(e===0||a>=e){return -1}if(a<0){a=e-Math.abs(a)}for(c=a;c<e;c++){if(this[c]===b){return c}}return -1}}if(!Array.prototype.map){Array.prototype.map=function(j,h){var b,a,c;if(this==null){throw new TypeError(" this is null or not defined")}var e=Object(this);var f=e.length>>>0;if(typeof j!=="function"){throw new TypeError(j+" is not a function")}if(arguments.length>1){b=h}a=new Array(f);c=0;while(c<f){var d,g;if(c in e){d=e[c];g=j.call(b,d,c,e);a[c]=g}c++}return a}}if(!Array.prototype.filter){Array.prototype.filter=function(b){if(this==null){throw new TypeError()}var f=Object(this);var a=f.length>>>0;if(typeof b!="function"){throw new TypeError()}var e=[];var d=arguments[1];for(var c=0;c<a;c++){if(c in f){var g=f[c];if(b.call(d,g,c,f)){e.push(g)}}}return e}}String.prototype.sanitize_for_hash=function(){if(!this||!this.length){return""}var b=new RegExp("([^a-zA-Z0-9-_/!@\\?])","g"),a=this.replace(b,"-");return a.replace(new RegExp("(-+)","g"),"-")};jQuery(document).ready(function(){TVE_Editor_Page.init();TVE_Editor_Page.overlay();jQuery(document).on("mousedown",".upload_image",function(b){b.preventDefault();thrive_open_media(jQuery(this),"load","image_element")});jQuery(document).on("mousedown",".upload_image_cpanel",function(b){b.preventDefault();thrive_open_media(jQuery(".edit_mode"),"save","image_element")});jQuery("html").on("click","#delete_icon",function(b){element=jQuery(".active_delete");tve_set_window_content_before_action();remove_element(element,element.parent());tve_set_window_content_after_action();hide_menu_icons();b.stopPropagation();b.preventDefault()});jQuery("html").on("click","#duplicate_icon",function(b){element=jQuery(".active_duplicate");tve_set_window_content_before_action();duplicate_element(element);tve_set_window_content_after_action();hide_menu_icons();b.stopPropagation()});TVE_Editor_Page.editor.on("paste",".edit_mode",function(d){var c=rangy.saveSelection();active_editor=jQuery(".edit_mode");var b=jQuery("<div contenteditable></div>");b.css("position","absolute").css("left","-1000px").css("top",active_editor.offset().top+"px").attr("id","pasteHelper").appendTo("body");b.focus();setTimeout(function(){jQuery(".edit_mode").focus();var k=rangy.getSelection();rangy.restoreSelection(c);k.deleteFromDocument();var f=k.getRangeAt(0);var e=tve_filter_paste(b);var g=document.createElement("div");g.innerHTML=e;var l=document.createDocumentFragment(),j,h;while((j=g.firstChild)){h=l.appendChild(j)}f.insertNode(l);f.collapseAfter(h);rangy.getSelection().setSingleRange(f);b.remove()},0.1)});data={style_families:tve_path_params.style_families,loaded_style:tve_path_params.loaded_style,user_templates:tve_path_params.user_templates,editor_dir:tve_path_params.editor_dir,template_uri:tve_path_params.template_uri,preview_url:tve_path_params.preview_url,tve_api_data:tve_path_params.tve_api_data,is_thrive_theme:tve_path_params.is_thrive_theme,current_theme_name:tve_path_params.current_theme_name,page_section_patterns:tve_path_params.page_section_patterns,display_options:tve_path_params.cpanel_display_options,thrive_optins:tve_path_params.thrive_optins?tve_path_params.thrive_optins:[],thrive_optin_colors:tve_path_params.thrive_optin_colors?tve_path_params.thrive_optin_colors:[],wp_timezone:tve_path_params.wp_timezone,wp_timezone_offset:tve_path_params.wp_timezone_offset,posts_categories:tve_path_params.posts_categories,custom_menus:tve_path_params.custom_menus,landing_page:tve_path_params.landing_page?tve_path_params.landing_page:"",landing_page_lightbox:tve_path_params.landing_page_lightbox,landing_page_config:tve_path_params.landing_page_config,landing_pages:tve_path_params.landing_pages,custom_fonts:tve_path_params.custom_fonts,font_settings_url:tve_path_params.font_settings_url,post_type:tve_path_params.post_type};jQuery.post(tve_path_params.cpanel_dir+"/control_panel.php",data,function(b){jQuery("body").prepend(b).addClass("tve_editor_page "+tve_path_params.extra_body_class);jQuery("html").addClass("tve-html-editor");TVE_Content_Builder.drag.init();rangy.init();jQuery("#tve_update_content").on("click",function(){tve_save_post(true)});jQuery("body").on("mousedown",".wp-picker-container",function(d){if(!window.textselection){window.textselection=rangy.saveSelection()}});TVE_Content_Builder.controls.dropdown_menus();tve_shortcode_colours=tve_path_params.shortcode_colours;colours_length=tve_shortcode_colours.length;colours_class_selector=new Array();for(var c=0;c<colours_length;c++){jQuery(".tve_cpanel_onpage .tve_"+tve_shortcode_colours[c]+":not(.tve_bullets_menu)").click(function(f){var d=jQuery(this);tve_set_window_content_before_action();tve_change_shortcode_colour.call(d,d.attr("class"),jQuery(".edit_mode"));tve_set_window_content_after_action();f.preventDefault()});colours_class_selector[c]="tve_"+tve_shortcode_colours[c]}colours_class_selector=colours_class_selector.join(" ");jQuery(".btn_alignment").click(function(){alignment=jQuery(this).attr("id");tve_change_shortcode_alignment(alignment,jQuery(".edit_mode"))});tve_init_sliders();jQuery("#tve_undo_manager").click(function(){TVE_Editor_Page.STATE==="enabled"&&tve_undoManager.undo()});jQuery("#tve_redo_manager").click(function(){TVE_Editor_Page.STATE==="enabled"&&tve_undoManager.redo()});jQuery(document).on("keydown",function(g){if(g.shiftKey&&!TVE_Editor_Page.SHIFT_KEY){TVE_Editor_Page.SHIFT_KEY=true;jQuery(TVE_Editor_Page).trigger("editor.shiftpressed")}if(g.ctrlKey&&g.which==83){tve_save_post(true);return false}if(TVE_Editor_Page.STATE!=="enabled"){return true}if(g.ctrlKey){if(g.which==90){tve_undoManager.undo()}else{if(g.which==89){tve_undoManager.redo()}}}else{if(g.altKey&&TVE_Editor_Page.CPANEL_OPEN){var d=[109,189,45,109,173],j=[61,187,107,43];if(jQuery.inArray(g.which,d)!==-1){TVE_Editor_Page.minimizeMenu()}else{if(jQuery.inArray(g.which,j)!==-1){TVE_Editor_Page.restoreMenu()}}}else{if(g.which==27){g.forceExit=1;clearFocus(g)}else{if(g.which==38){var h=jQuery("input:focus");if(!h.is(".margin-control")&&!h.is(".padding-control")&&!h.is(".tve_font_size")){return true}h.val(parseInt(h.val())+1).change()}else{if(g.which==40){var h=jQuery("input:focus"),f=(parseInt(h.val())-1);if(!h.is(".margin-control")&&!h.is(".padding-control")&&!h.is(".tve_font_size")){return true}h.val(f<0?0:f).change()}}}}}});jQuery(document).on("keyup",function(d){TVE_Editor_Page.SHIFT_KEY=false;jQuery(TVE_Editor_Page).trigger("editor.shiftreleased")});jQuery(".tve_menu, #tve_cpanel, #tve_lightbox_frame, #tve_mce_holder, #tve_editor").on("change",".tve_change",function(g){var f=jQuery(this),d="";if(f.parents(".tve_menu").length){d=f.parents(".tve_menu").first().parent().attr("id").replace("_menu","")}if(!f.attr("data-skip-undo")){tve_set_window_content_before_action()}f.data("type",d);tve_event_change(f,jQuery(".edit_mode"),d,g);if(!f.attr("data-skip-undo")){tve_set_window_content_after_action()}}).on("click",".tve_click",function(f){var g=jQuery(this),e="";if(g.parents(".tve_menu").length){e=g.parents(".tve_menu").first().parent().attr("id").replace("_menu","")}if(!g.attr("data-skip-undo")){tve_set_window_content_before_action()}g.data("type",e);var d=tve_event_click(g,jQuery(".edit_mode"),e,f);if(!g.attr("data-skip-undo")){tve_set_window_content_after_action()}if(d){f.stopPropagation()}}).on("mousedown",".tve_mousedown",function(e){var f=jQuery(this),d="";if(f.parents(".tve_menu").length){d=f.parents(".tve_menu").first().parent().attr("id").replace("_menu","")}f.data("type",d);tve_event_mousedown(f,jQuery(".edit_mode"),d,e)});jQuery(".tve_datepicker").each(function(){var e=jQuery(this),d=null;switch(this.id){case"ct_date":d=function(f){jQuery(".edit_mode").tve_countdown_timer().set("date",f.val())};break}e.datepicker({dateFormat:"yy-mm-dd",onSelect:function(){if(typeof d==="function"){d(e)}}}).attr("readonly","readonly")});setTimeout(function(){TVE_Editor_Page.overlay(true)},200)});var a=function(b){if(b.ctrlKey){var c="";switch(b.keyCode){case 66:c="bold_text";break;case 73:c="italic_text";break;case 85:c="underline_text";break}if(c!==""){TVE_Content_Builder.controls.rangy_cls(null,null,b,c);b.preventDefault();b.stopPropagation()}}};jQuery("#tve_editor").on("keydown",".edit_mode",a)});var clearFocus=function(h){if(TVE_Editor_Page.STATE==="disabled"){return false}var a=jQuery(h.target);if(a.hasClass("tve_no_hide")){return true}if(!a.is(block_clear_focus)||h.forceExit===1||a.is("#tve_submenu_close")){var f=rangy.getSelection(),c=false;if(f.rangeCount>0&&f.toString().length){var d=f.getRangeAt(0),g=d.commonAncestorContainer;if(g.nodeType==3){g=g.parentNode}if(last_mouse_down===g){c=true}}if(h.forceExit!==1&&!a.is("#tve_submenu_close")&&(c||(f.toString().length&&a.hasClass("edit_mode")))){return false}f.toString().length&&f.removeAllRanges();var b=jQuery(".edit_mode");if(b.parent().is("a")&&b.parent().data("remove-draggable")){b.parent().removeAttr("draggable");b.parent().data("remove-draggable",0)}b.off(".editHyperlinks");if(b.parent().is(".thrv_tw_quote")&&b.text().length>140){tve_add_notification("Tweet text limit accepts maximum 140 characters !",true,4000)}tve_hide_hyperlink_options();h.stopPropagation&&h.stopPropagation();tve_refresh(false);jQuery(document).off(".clearFocus");TVE_Editor_Page.restoreMenu();TVE_Editor_Page.CPANEL_OPEN=false}};function tve_edit_hyperlinks(b){var a=jQuery(b.target);if(!a.is("a")){a=a.parents("a").first()}a.addClass("tve_active_hyperlink");jQuery(".tve_link_btns").show();tve_populate_hyperlink_fields()}function tve_populate_hyperlink_fields(){active_link=jQuery(".tve_active_hyperlink");jQuery("#link_anchor").val(jQuery(active_link).text());jQuery("#link_url").val(jQuery(active_link).attr("href"));jQuery("#anchor_name").val(jQuery(active_link).attr("name"));if(jQuery(active_link).attr("target")=="_blank"){jQuery("#link_new_window").prop("checked",true)}else{jQuery("#link_new_window").prop("checked",false)}if(jQuery(active_link).attr("rel")=="nofollow"){jQuery("#link_no_follow").prop("checked",true)}else{jQuery("#link_no_follow").prop("checked",false)}}function tve_hide_hyperlink_options(){jQuery(".tve_active_hyperlink").removeClass("tve_active_hyperlink");jQuery(".tve_link_btns").hide()}function enable_sortables(){var c=false,a=null,b=function(d,h){if(jQuery(".edit_mode").length||d.is(".tve_not_editable")){return false}a=d;if(c){var g=d,f=g;while(!g.is(TVE_Editor_Page.editor)&&!g.is("html")){if(g.is(right_menu_hover_items)){f=g}g=g.parent()}d=f}if(d.is(elements_with_no_menu_icons)){hide_element_left_menu();hide_element_right_menu();jQuery(".active_highlight").removeClass("active_highlight");if(d.hasClass("tve_p_lb_control")||d.hasClass("tve_p_lb_content")){d=d.closest(".tve_p_lb_content")}d.addClass("active_highlight");return false}hide_element_left_menu();hide_element_right_menu();shortcode_wrapper=tve_get_shortcode_wrapper_hover(d);if(d.is(elements_without_delete_button)){if(shortcode_wrapper){element_left_position=jQuery(shortcode_wrapper).offset().left;element_top_position=jQuery(shortcode_wrapper).offset().top;element_width=jQuery(shortcode_wrapper).outerWidth();display_element_right_menu(shortcode_wrapper,element_left_position,element_top_position,element_width);if(jQuery(shortcode_wrapper).is(left_menu_hover_items)){if(!jQuery(shortcode_wrapper).is(elements_no_left_menu)){display_element_left_menu(shortcode_wrapper,element_left_position,element_top_position)}}return false}}element_left_position=d.offset().left;element_top_position=d.offset().top;element_width=d.outerWidth();display_element_right_menu(d,element_left_position,element_top_position,element_width);if(d.is(left_menu_hover_items)){if(!jQuery(shortcode_wrapper).is(elements_no_left_menu)){display_element_left_menu(d,element_left_position,element_top_position)}}return true};jQuery(TVE_Editor_Page).bind("editor.shiftpressed",function(d){c=true;if(a){b(a,d)}});jQuery(TVE_Editor_Page).bind("editor.shiftreleased",function(d){if(!c){return true}c=false;if(a){b(a,d)}});TVE_Editor_Page.editor.on("mouseover",right_menu_hover_items,function(g){if(TVE_Editor_Page.STATE==="disabled"){return false}var d=jQuery(this),f=b(d,g);if(f===false){return false}g.stopPropagation()});TVE_Editor_Page.editor.on("mouseleave",right_menu_hover_items,function(f){var d=f||window.event;if(d.relatedTarget!=document.getElementById("delete_icon")&&d.relatedTarget!=document.getElementById("duplicate_icon")){hide_element_right_menu();hide_element_left_menu();f.stopPropagation();a=null;last_context=null}});jQuery(document).on("mouseleave","#delete_icon, #duplicate_icon",function(d){jQuery(".active_delete, .active_duplicate").removeClass("active_delete active_duplicate");jQuery("#duplicate_icon, #delete_icon").hide();d.stopPropagation()})}function remove_element(e,c){var b=jQuery(e),f=[];if(b.tve_color_selector()){f.push(b.tve_color_selector())}b.find("[data-tve-custom-colour]").each(function(){var g=jQuery(this);if(g.tve_color_selector()){f.push(g.tve_color_selector())}});for(var d=0,a;a=f[d++];){tve_remove_css_rule(a)}if(b.is(".thrv_tabs_shortcode > .tve_scT > ul li")){b.parents(".thrv_tabs_shortcode").first().tve_tabs().removeTab(b);return true}if(contains_nested_elements.indexOf(c.get(0).tagName)!=-1){if(jQuery(c).find("li").length==1){if(jQuery(c).parent().is(".thrv_bullets_shortcode")){jQuery(c).parent().remove()}else{jQuery(c).remove()}}}if(jQuery(e).is("img")&&jQuery(e).parents(".tve_image_caption").first().length!=0){jQuery(e).parents(".tve_image_caption").first().remove()}TVE_Content_Builder.drag.before_remove(e);e.remove()}function tve_refresh(b){var a=jQuery(".edit_mode");jQuery("p:empty").html("&#x200b");jQuery('[contentEditable="true"]').attr("contentEditable","false");a.parents(".tve_draggable").filter(":not(body,.tve_no_drag)").attr("draggable","true");a.removeClass("edit_mode").filter(":not(body,.tve_no_drag)").not(text_elements_inline_only).attr("draggable","true");jQuery(".edit_light, .edit_dark").removeClass("edit_light").removeClass("edit_dark");if(b){enable_sortables()}hide_control_panel_menu();jQuery(".thrv_custom_html_shortcode").each(function(){var c=jQuery(this);if(c.height()==0&&c.find("."+custom_html_placeholder_class).length===0){c.append(custom_html_default_html)}})}function getMouseEventCaretRange(b){var c,a=b.clientX,e=b.clientY;if(document.body.createTextRange){c=document.body.createTextRange();c.moveToPoint(a,e)}else{if(typeof document.createRange!="undefined"){if(typeof b.rangeParent!="undefined"){c=document.createRange();c.setStart(b.rangeParent,b.rangeOffset);c.collapse(true)}else{if(document.caretPositionFromPoint){var d=document.caretPositionFromPoint(a,e);c=document.createRange();c.setStart(d.offsetNode,d.offset);c.collapse(true)}else{if(document.caretRangeFromPoint){c=document.caretRangeFromPoint(a,e)}}}}}return c}function selectRange(a){if(a){if(typeof a.select!="undefined"){a.select()}else{if(typeof window.getSelection!="undefined"){var b=window.getSelection();b.removeAllRanges();b.addRange(a)}}}}function thrive_open_media(b,f,d,a,c){var e;jQuery(".tve_active_image").removeClass("tve_active_image");if(b){if(f=="load"){b.parent().addClass("tve_active_image")}else{b.addClass("tve_active_image")}}if(e){e.open();return}e=wp.media.frames.file_frame=wp.media({title:jQuery(this).data("uploader_title"),button:{text:jQuery(this).data("uploader_button_text")},multiple:false,frame:"post"});var g=false;if(b&&jQuery(b).parents().is(".thrv_feature_grid")){g=true}var h=function(k){if(f=="save"){jQuery(".tve_active_image").tve_image().attach(k)}else{if(d=="image_element"&&!g){data={url:k.url,alt_text:k.alt,caption:k.caption,id:k.id,width:k.width,height:k.height};jQuery.post(tve_path_params.shortcodes_dir+"thrv_image_load.php",data,function(m){tve_set_window_content_before_action();var l=jQuery(m),n=jQuery(".tve_active_image");if(n.hasClass("fwi")){l.addClass("fwi")}n.replaceWith(l);TVE_Content_Builder.drag.bind_draggable(l);tve_set_window_content_after_action()})}else{if(d=="image_element"&&g){data={url:k.url,alt_text:k.alt};jQuery.post(tve_path_params.shortcodes_dir+"thrv_image_load_feature_gallery.php",data,function(l){jQuery(".tve_active_image").replaceWith(l)})}else{if(d=="testimonial_button"){a.find("img").attr("src",k.url)}else{if(d=="page_section_background"){a.tve_page_section().setBgImage(k)}else{if(d==="icon_element"){a.find("i").removeClass(function(m,l){var p=l.split(" "),n="";for(var m=0,o;o=p[m++];){if(o=="tve_sc_icon"||o.indexOf("icon-")===0){n+=" "+o}}return jQuery.trim(n)}).css("background-image","url("+k.url+")").css("background-size","cover")}else{if(d=="lightbox_content_background"){a.tve_lightbox().setBgImage(k)}else{if(d=="lp_background"){a.tve_lp().setBgImage(k)}}}}}}}}var j=jQuery("#tve_editor").find(".out").removeClass("out");setTimeout(function(){j.addClass("out")},0)};e.on("select",function(){var j=jQuery.extend({alt:"",caption:"",id:""},e.state().props.toJSON());if(e.state().get("type")!="image"){return}h(j)});e.on("insert",function(){h(e.state().get("selection").first().toJSON())});e.open();if(e.menu&&e.menu.get&&e.menu.get()._views&&e.menu.get()._views.gallery){e.menu.get()._views.gallery.$el.remove()}if(e.menu&&e.menu.get&&e.menu.get()._views&&e.menu.get()._views.playlist){e.menu.get()._views.playlist.$el.remove()}}function convert_element_into_edit_mode(b,c){c.stopPropagation();tve_refresh(false);hide_sub_menu();hide_element_right_menu();hide_element_left_menu();b.addClass("edit_mode");b.hasClass("tve_draggable")&&b.removeAttr("draggable");b.parents(".tve_draggable").removeAttr("draggable");var a=b.children();if(b.is(text_elements)){b.attr("contenteditable","true");if(c.type=="click"&&!(jQuery(c.target).is(selection_loss_tags))){var d=getMouseEventCaretRange(c);window.setTimeout(function(){selectRange(d)},10)}if(b.is(text_elements_inline_only)){if(b.parent().is("a")){b.parent().attr("draggable","false").data("remove-draggable",true)}load_control_panel_menu(c.target,"text_inline_only")}else{if(!b.is(text_element_no_formatting)){load_control_panel_menu(c.target,"text")}}}else{if(b.is("img")){c.preventDefault();load_control_panel_menu(b,"img");if(jQuery(b).parent().is("a")){jQuery(".tve_link_btns").show()}}else{if(a.is(".tve_btn")){c.preventDefault();load_control_panel_menu(c.target,"button")}else{if(a.is(".tve_cb")){c.preventDefault();load_control_panel_menu(c.target,"contentbox")}else{if(a.is(".tve_fg")){c.preventDefault();load_control_panel_menu(c.target,"guarantee")}else{if(a.is(".tve_ca")){c.preventDefault();load_control_panel_menu(c.target,"calltoaction")}else{if(a.is(".tve_ts")){c.preventDefault();load_control_panel_menu(c.target,"testimonial")}else{if(a.is(".tve_ul")){c.preventDefault();load_control_panel_menu(c.target,"bullets")}else{if(a.is(".tve_scT")){c.preventDefault();load_control_panel_menu(c.target,"tabs")}else{if(a.is(".tve_faq")){c.preventDefault();load_control_panel_menu(c.target,"toggle")}else{if(b.is(".thrv_custom_html_shortcode")){c.preventDefault();load_control_panel_menu(c.target,"custom_html")}else{if(b.is(".thrv_feature_grid")){c.preventDefault();load_control_panel_menu(c.target,"feature_grid")}else{if(b.is(".thrv_cc_icons, .thrv_cc_wrapper, .tve_cc_logo")){c.preventDefault();b=tve_get_shortcode_wrapper_click(c.target);load_control_panel_menu(b,"cc_icons")}else{if(b.is(".thrv_page_section")){c.preventDefault();load_control_panel_menu(b,"page_section")}else{if(b.is(".tve_prt")){c.preventDefault();load_control_panel_menu(b,"pricing_table")}else{if(b.is(".thrv_content_container_shortcode")){c.preventDefault();load_control_panel_menu(b,"content_container")}else{if(b.is(".thrv_table")){c.preventDefault();load_control_panel_menu(b,"table")}else{if(b.is(".tve_table_cell")){c.preventDefault();load_control_panel_menu(b,"table_cell")}else{if(b.is(".thrv_thrive_optin")){c.preventDefault();load_control_panel_menu(b,"thrive_optin")}else{if(b.is(".thrv_content_reveal")){c.preventDefault();load_control_panel_menu(b,"content_reveal")}else{if(b.is(".thrv_countdown_timer")){c.preventDefault();if(b.hasClass("tve_countdown_timer_evergreen")){load_control_panel_menu(b,"countdown_timer_evergreen")}else{load_control_panel_menu(b,"countdown_timer")}}else{if(b.is(".thrv_posts_list")){c.preventDefault();load_control_panel_menu(b,"thrive_posts_list")}else{if(b.is(".thrv_custom_phone")){c.preventDefault();load_control_panel_menu(b,"thrive_custom_phone")}else{if(b.is(".thrv_custom_menu")){c.preventDefault();load_control_panel_menu(b,"thrive_custommenu")}else{if(b.is(".thrv_responsive_video")){c.preventDefault();load_control_panel_menu(b,"responsive_video")}else{if(b.is(".thrv_contents_table")){c.preventDefault();load_control_panel_menu(b,"contents_table")}else{if(b.is(".thrv_tw_qs")){c.preventDefault();load_control_panel_menu(b,get_shortcode_type_from_edit_mode(b))}else{if(b.is(".thrv_star_rating")){c.preventDefault();load_control_panel_menu(b,"rating")}else{if(b.is(".tve_wp_shortcode")){c.preventDefault();load_control_panel_menu(b,"shortcode")}else{if(b.is(".thrv_lead_generation")){c.preventDefault();load_control_panel_menu(b,get_shortcode_type_from_edit_mode(b))}else{if(b.is("ul.thrv_wrapper")||b.is("ol.thrv_wrapper")){c.preventDefault();load_control_panel_menu(b,"lists")}else{if(get_shortcode_type_from_edit_mode(b)==="widget"){c.preventDefault();load_control_panel_menu(b,get_shortcode_type_from_edit_mode(b))}else{if(b.hasClass("tve_p_lb_control")){c.preventDefault();load_control_panel_menu(b,"lightbox")}else{if(b.hasClass("tve_wrap_all")){c.preventDefault();load_control_panel_menu(b,"landing_page")}else{if(b.hasClass("tve_lp_content")){c.preventDefault();load_control_panel_menu(b,"landing_page_content")}else{if(b.hasClass("thrv_post_grid")){c.preventDefault();load_control_panel_menu(b,"post_grid")}else{if(b.hasClass("thrv_icon")){c.preventDefault();load_control_panel_menu(b,"icon");if(b.find("a").length==0){tve_hide_hyperlink_options()}else{jQuery(".tve_link_btns").show()}}else{load_control_panel_menu(b,"default_element")}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}setTimeout(function(){b.focus()},0);return true}function activate_editmode_keyboard_listener(){jQuery(document).on("keydown.editmode",function(c){var b=jQuery(".edit_mode");if(jQuery(":focus").is(b)){if(b.is(text_elements)){if(c.which==13&&!c.shiftKey){c.preventDefault();block_container=get_parent_block_element(b);block_container_tag_name=block_container.get(0).tagName;if(block_container_tag_name!="PRE"){var a=get_text_after_cursor(),d=jQuery(a).text()}switch(block_container_tag_name){case"P":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"ADDRESS":remove_contenteditable_true();if(!jQuery.trim(d)){block_container_tag_name="P"}add_paragraph_to_dom(b,a,get_cursor_offset(),c,block_container_tag_name);break;case"UL":remove_contenteditable_true();add_li_to_dom(b,a,"UL",get_cursor_offset(),c);break;case"OL":remove_contenteditable_true();add_li_to_dom(b,a,"OL",get_cursor_offset(),c);break;case"BLOCKQUOTE":remove_contenteditable_true();add_blockquote_to_dom(b,a,c);break;case"PRE":add_break_to_dom(b,c);break}return true}if(c.which==13&&c.shiftKey){c.preventDefault();add_break_to_dom(b,c);return true}if(c.which==9){document.execCommand("indent",true,null);if(c.preventDefault){c.preventDefault()}}}if(b.is("img")){if(c.which==46||c.which==8){b.remove()}}}})}function remove_contenteditable_true(){jQuery("[contenteditable]").removeAttr("contenteditable")}function add_blockquote_to_dom(c,b,d){var a=jQuery('<blockquote contenteditable="true"></blockquote>').append(b);c.after(a);c.next("blockquote").focus();convert_element_into_edit_mode(c.next("blockquote"),d);TVE_Content_Builder.drag.after_clone(c,a)}function add_li_to_dom(d,b,c,g,f){if(!g){d.html("&#x200b")}if(d.text()){var a=d.clone().append(b).removeClass("edit_mode active_delete active_duplicate tve_draggable").removeAttr("draggable");d.after(a);a.focus();convert_element_into_edit_mode(a,f)}else{d.replaceWith("</"+c+">");add_paragraph_to_dom(d,b,f)}}function add_paragraph_to_dom(b,a,g,f,d){if(!g){b.html("&#x200b")}var c=jQuery("<"+d+"></"+d+">").append(a);b.after(c);TVE_Content_Builder.drag.after_clone(b,c);tve_copy_style(b,c);c.focus();f.target=c;convert_element_into_edit_mode(c,f)}function add_break_to_dom(a,d){var c=rangy.getSelection();if(c.getRangeAt&&c.rangeCount){range=c.getRangeAt(0);var b=document.createElement("br");range.insertNode(b);c.collapse(b.parentNode,1+tve_get_node_index(b));range.setStart(b.parentNode,1+tve_get_node_index(b));range.setEnd(b.parentNode,1+tve_get_node_index(b));if(tve_is_empty_line_break(b)){range.insertNode(document.createElement("br"));c.collapse(b.parentNode,1+tve_get_node_index(b));range.setStart(b.parentNode,1+tve_get_node_index(b));range.setEnd(b.parentNode,1+tve_get_node_index(b))}}}function get_parent_block_element(a){tag_name=jQuery(a).get(0).tagName;if(block_tags.indexOf(tag_name)!=-1){return a}else{return a.parents(block_tags).first()}}function load_control_panel_menu(b,c){hide_control_panel_menu();var a=jQuery(".edit_mode");menu_wrapper=jQuery(".tve_cpanel_onpage").removeClass(function(e,f){var h=f.split(" "),g="";for(var e=0,d;d=h[e++];){if(d==="tve-after-element"||d.indexOf("menu_elem_")===0||d=="tve_menu_visible"){g+=(g?" ":"")+d}}return g}).addClass("menu_elem_"+c);if(c=="landing_page"){setTimeout(function(){menu_wrapper.addClass("tve_menu_visible")},100)}menu_to_show=jQuery(".tve_secondLayer, #"+c+"_menu, .tve_clear");if(c==="img"){menu_to_show.find(".tve_hidden_feature_grid")[a.parents(".thrv_feature_grid .tve_gri").length?"hide":"show"]()}else{if(c==="icon"){menu_to_show.find(".tve_hide_cb")[a.parent().hasClass("tve_cb_symbol")?"hide":"show"]();if(a.find("> .tve_sc_text").length){menu_to_show.find(".tve_text_ctrl").show();menu_to_show.find(".tve_icon_ctrl").hide()}else{menu_to_show.find(".tve_icon_ctrl").show();menu_to_show.find(".tve_text_ctrl").hide()}}else{if(c==="contentbox"){menu_to_show.find(".tve_symbol_ctrl")[a.find("> .tve_cb_symbol").length?"show":"hide"]()}}}editor_pos=TVE_Editor_Page.editor.offset();editor_width=TVE_Editor_Page.editor.width();menu_wrapper.css("width",editor_width+"px");element_pos=a.offset();tve_upgrade_element(c);jQuery.when(menu_wrapper.show(),menu_to_show.show()).done(function(){if(c!="landing_page"){menu_wrapper_height=menu_wrapper.height();if(c=="lightbox"){var d=jQuery(".tve_p_lb_content").position().top-10-menu_wrapper_height;menu_wrapper.css("top",(d<32?32:d)+"px")}else{var d=element_pos.top-10-menu_wrapper_height;d-=TVE_Editor_Page.getPositionOffset(menu_wrapper);if(c=="landing_page_content"){d=element_pos.top-32}if(d<32){d=element_pos.top+a.outerHeight()-32;menu_wrapper.addClass("tve-after-element")}menu_wrapper.css("top",d+"px");menu_wrapper.css("left",editor_pos.left+"px")}}load_button_values(a,c);if(c==="text"&&a.text()===a.data("default")){setTimeout(function(){var e=rangy.createRange();e.selectNodeContents(b);rangy.getSelection().setSingleRange(e)},1)}else{if(c==="tabs"){if(a.find("> .tve_vtabs").length){jQuery("#vtabs_menu_width").show()}else{jQuery("#vtabs_menu_width").hide()}}}if(c==="text"){if(a.is("li")){jQuery("#"+c+"_menu").find(".tve_margin_control").hide()}else{jQuery("#"+c+"_menu").find(".tve_margin_control").show()}}});TVE_Content_Builder.colors.on_menu_show(c,tve_get_shortcode_wrapper_click(b))}function hide_control_panel_menu(){jQuery(".tve_cpanel_onpage, .tve_secondLayer, .tve_secondLayer>div").removeClass("tve_menu_visible").hide()}function display_element_right_menu(b,a,d,c){jQuery(".active_delete, .active_duplicate").removeClass("active_delete active_highlight");jQuery(b).addClass("active_delete");var e=jQuery("#delete_icon");delete_icon_width=20;delete_icon_height=20;e.css("left",(a+c)-delete_icon_width+"px");e.css("top",(d)+"px");e.show()}function display_element_left_menu(c,b,d){jQuery(".active_duplicate, .active_highlight").removeClass("active_duplicate active_highlight");jQuery(c).addClass("active_duplicate");var a=jQuery("#duplicate_icon");duplicate_icon_height=20;a.css("left",b+"px");a.css("top",d+"px");a.show()}function hide_element_right_menu(){jQuery("#delete_icon").hide();jQuery(".active_delete,.active_highlight").removeClass("active_delete active_highlight")}function hide_element_left_menu(){jQuery("#duplicate_icon").hide();jQuery(".active_duplicate,.active_highlight").removeClass("active_duplicate active_highlight")}function add_element_menu_icons(){jQuery("html").prepend("<div id='delete_icon'></div>").prepend("<div id='duplicate_icon'></div>");cpanel_pos_class="";if(tve_path_params.cpanel_display_options.position=="left"){cpanel_pos_class=" tve_is_flipped"}}function getBlockContainer(a){while(a){if(a.nodeType==1&&/^(A|P|H[1-6]|DIV|OL|UL|LI|PRE|ADDRESS|BLOCKQUOTE)$/i.test(a.nodeName)){return a}a=a.parentNode}}function get_text_after_cursor(){var c=rangy.getSelection();if(c.rangeCount){var a=c.getRangeAt(0);var d=getBlockContainer(a.endContainer);if(d){var b=a.cloneRange();b.selectNodeContents(d);b.setStart(a.endContainer,a.endOffset);return b.extractContents()}}}function get_cursor_offset(){sel=rangy.getSelection();if(sel.rangeCount){selRange=sel.getRangeAt(0);return selRange.startOffset}}function tve_get_shortcode_wrapper_hover(a){if(jQuery(a).is(".thrv_wrapper")){return a}else{var b=jQuery(a).parents(".thrv_wrapper, .tve_faq").first();if(b.length!==0){return b}else{return false}}}function tve_get_shortcode_wrapper_click(a){a=jQuery(a);if(a.is(".thrv_wrapper,img")||a.hasClass("tve_p_lb_control")||a.hasClass("tve_wrap_all")){return a}else{var b=jQuery(a).parents(".thrv_wrapper").first();if(b.length!==0){return b}else{return false}}}function duplicate_element(a){var b=a.clone();a.after(b);tve_clone_custom_styles(a,b);TVE_Content_Builder.drag.after_clone(a,b)}function hide_menu_icons(){jQuery("#delete_icon, #duplicate_icon").hide()}function tve_add_notification(c,a,b){error_box=jQuery("#tve_notification_box");if(a){jQuery(error_box).addClass("tve_error_box")}else{jQuery(error_box).removeClass("tve_error_box")}if(typeof b==="undefined"){b=2000}jQuery(error_box).text(c);jQuery(error_box).animate({left:100},700);setTimeout(function(){jQuery(error_box).animate({left:-950},700)},b)}function tve_editor_init(h,c){h.preventDefault();var f=rangy.getSelection();if(f.toString().length||c.is(".tve_not_editable")){return false}var a=jQuery(h.target),b=jQuery(h.currentTarget),d,g;if(TVE_Editor_Page.SHIFT_KEY){d=g=c;while(!g.is(TVE_Editor_Page.editor)&&!g.is("html")){if(g.is(editable_elements)){d=g}g=g.parent()}if(!d.is(c)){a=b=c=d}}if(a.is(block_editing_elements)&&b.is(block_editing_elements)){if(a.is(".tve_cc_logo")||a.is(".thrv_custom_html_shortcode *")){c=tve_get_shortcode_wrapper_click(h.target);h.target=c}else{return false}}h.preventDefault();if(!a.hasClass("edit_mode")){convert_element_into_edit_mode(c,h);jQuery(document).on("click.clearFocus",document,clearFocus);jQuery(".edit_mode").on("click.editHyperlinks","a",tve_edit_hyperlinks)}else{if(!a.is("a")){tve_hide_hyperlink_options()}h.stopPropagation()}TVE_Editor_Page.restoreMenu();TVE_Editor_Page.CPANEL_OPEN=true}window.onbeforeunload=function(){return"If you leave this page then any unsaved changes will be lost"};function tve_filter_paste(a){filtered_textarea_html=jQuery.htmlClean(jQuery(a).html(),{format:true,removeTags:["span","div"],removeAttrs:["class"]});return filtered_textarea_html}function tve_set_window_content_before_action(){var a=jQuery("<div></div>").html(TVE_Editor_Page.editor.html());a.find(".tve_placeholder, .tve-ui-helper").remove();window.beforeMove=a.html();a.remove()}function tve_set_window_content_after_action(){tve_add_undo_action("sortable",window.beforeMove,TVE_Editor_Page.editor.html())}function tve_add_undo_action(b,a,c){if(b=="sortable"){tve_undoManager.add({undo:function(){tve_restore_editor_content(a)},redo:function(){tve_restore_editor_content(c)}})}}function tve_restore_editor_content(a){TVE_Editor_Page.editor.html(a);jQuery(TVE_Editor_Page).trigger("editor.onundo")}function tve_copy_style(a,b){b.attr("style",a.attr("style"))}function tve_is_empty_line_break(b){var c=b.parentNode;while(jQuery.getComputedStyle(c).display=="inline"){c=c.parentNode}var f={height:c.style.height,maxHeight:c.style.maxHeight,minHeight:c.style.minHeight};c.style.height="auto";c.style.maxHeight="none";if(!(jQuery.browser.msie&&jQuery.browser.version<8)){c.style.minHeight="0"}var d=document.createTextNode("\u200b");var e=c.offsetHeight;if(e==0){throw"isCollapsedLineBreak: original height is zero, bug?"}b.parentNode.insertBefore(d,b.nextSibling);var a=c.offsetHeight;d.parentNode.removeChild(d);c.style.height=f.height;c.style.maxHeight=f.maxHeight;if(!(jQuery.browser.msie&&jQuery.browser.version<8)){c.style.minHeight=f.minHeight}return e<a-5}function tve_get_node_index(b){var a=0;while((b=b.previousSibling)){a++}return a}jQuery.getComputedStyle=function(b,a){if(window.getComputedStyle){return window.getComputedStyle(b,a)}if(b.currentStyle){return b.currentStyle}return null};var tve_stylesheet=(function(){var a=jQuery(".tve_custom_style");if(!a.length){a=jQuery('<style type="text/css" class="tve_custom_style"></style>').appendTo(jQuery("head"))}var b=a[0];if(b.styleSheet){b.styleSheet.cssText=b.styleSheet.cssText+""}else{b.appendChild(document.createTextNode(""))}return b.sheet})();function tve_add_css_rule(b,h,c){try{var a=tve_stylesheet.cssRules?tve_stylesheet.cssRules:tve_stylesheet.rules,g="",f=false,d;for(d=0;d<a.length;d++){if(a[d].selectorText===b){g+=a[d].style.cssText;f=true}}if(f){tve_remove_css_rule(b);h=g+h}if(tve_stylesheet.insertRule){tve_stylesheet.insertRule(b+"{"+h+"}",c)}else{tve_stylesheet.addRule(b,h,c)}}catch(e){txt="There was an error on this page.\n\n";txt+="Error description: "+e.message+"\n\n";txt+="Click OK to continue.\n\n";alert(txt)}}function tve_direct_css_insert(a){if(tve_stylesheet.insertRule){tve_stylesheet.insertRule(a,0)}else{tve_stylesheet.addRule(a,0)}}function tve_clone_custom_styles(c,a){var b=new Array();a.find("[data-tve-custom-colour]").each(function(){css_id=jQuery(this).attr("data-tve-custom-colour");if(!css_id){return true}if(b.indexOf(css_id)==-1){css_rules=new Array();css_rules=tve_return_css_rule(css_id);new_unique_id=tve_get_unique_css_identifier(jQuery(this),false);for(var d=0;d<css_rules.length;d++){new_css_rule=css_rules[d].replace(css_id,new_unique_id);tve_direct_css_insert(new_css_rule)}jQuery(a).find("[data-tve-custom-colour='"+css_id+"']").each(function(){if(b.indexOf(jQuery(this).attr("data-tve-custom-colour"))==-1){jQuery(this).attr("data-tve-custom-colour",new_unique_id)}});b.push(css_id)}})}function tve_remove_css_rule(c,e,f){if(typeof f==="undefined"){f=""}var b=tve_stylesheet.cssRules?tve_stylesheet.cssRules:tve_stylesheet.rules,d='[data-tve-custom-colour="'+c+'"]'+f,a="[data-tve-custom-colour='"+c+"']"+f;tve_stylesheet.crossdelete=tve_stylesheet.deleteRule?tve_stylesheet.deleteRule:tve_stylesheet.removeRule;for(i=0;i<b.length;i++){if(b[i].selectorText.indexOf(c)===-1){continue}if(b[i].selectorText==d||b[i].selectorText==a){if(typeof e!=="undefined"&&e){jQuery.each(e.split(" "),function(g,h){if(b[i].style.removeProperty){b[i].style.removeProperty(h)}else{if(b[i].style.removeAttribute){b[i].style.removeAttribute(h)}}})}else{tve_stylesheet.crossdelete(i);i--}}}}function tve_return_css_rule(b){selector='[data-tve-custom-colour="'+b+'"]';var a=tve_stylesheet.cssRules?tve_stylesheet.cssRules:tve_stylesheet.rules;tve_stylesheet.crossdelete=tve_stylesheet.deleteRule?tve_stylesheet.deleteRule:tve_stylesheet.removeRule;matching_rules=new Array();for(i=0;i<a.length;i++){if(a[i].selectorText.toLowerCase().indexOf(b)!=-1){matching_rules.push(a[i].cssText)}}return matching_rules}function tve_extract_stylesheet_rules(){var a=tve_stylesheet.cssRules?tve_stylesheet.cssRules:tve_stylesheet.rules;var d="",b;for(var c=0;c<a.length;c++){b=a[c].selectorText.replace(":hover","");if(jQuery(b).length){d=d+a[c].cssText+"\n"}}return d}function tve_extract_stylesheet_rules_filtered(f){if(!f||!f.length){return""}var a=tve_stylesheet.cssRules?tve_stylesheet.cssRules:tve_stylesheet.rules;var e="";for(var c=0;c<a.length;c++){for(var b=0,d;d=f[b++];){if(a[c].selectorText.indexOf(d)!==-1){e=e+a[c].cssText+"\n"}}}return e}function tve_get_unique_css_identifier(a,b){if(jQuery(a).attr("data-tve-custom-colour")&&b){return jQuery(a).attr("data-tve-custom-colour")}else{rand_id=Math.floor((Math.random()*100000000)+1);jQuery(a).attr("data-tve-custom-colour",rand_id);return rand_id}}function tve_remove_custom_colours(a){tve_remove_css_rule(a.tve_color_selector());if(a.is("img")){a.removeAttr("data-tve-custom-colour")}jQuery(a).find("[data-tve-custom-colour]").each(function(){var b=jQuery(this);tve_remove_css_rule(b.tve_color_selector());b.removeAttr("data-tve-custom-colour")})}function escapeHTML(a){return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function modify_selector_edit_mode(a){var c=a.split(",");for(var b=0;b<c.length;b++){c[b]=c[b].replace(/^\s*|\s*$/g,"");c[b]=".edit_mode "+c[b]}return c.join(",")}function replaceAll(c,a,b){return b.replace(new RegExp(escapeRegExp(c),"g"),a)}function escapeRegExp(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function tve_provess_saved_template(g,f){f.find(".edit_mode").removeClass("edit_mode");if(!jQuery.trim(g)){return f}var k=f.wrapAll("<div></div>").parent();g=jQuery.trim(g);var h=g.match(/[^{}]+(?=\})/g),d=g.match(/\[(.*?)\]([^\{]*)/g),c={};for(var e=0;e<d.length;e++){var j=d[e].match(/\[data-tve-custom-colour=([^0-9]{1,1})(\d+)('|")\]/);if(!j||j.length<3){continue}var a=typeof c["code"+j[2]]!=="undefined"?c["code"+j[2]]:tve_get_unique_css_identifier(k.find('[data-tve-custom-colour="'+j[2]+'"]'),false),b=d[e].replace(j[2],a);tve_add_css_rule(b,h[e],0);c["code"+j[2]]=a}return f.unwrap()}function tve_change_shortcode_alignment(d,b){element_type=get_shortcode_type_from_edit_mode(b);switch(element_type){case"button":b.removeClass("tve_leftBtn tve_centerBtn tve_rightBtn tve_fullwidthBtn").addClass(d);break;case"content_container":b.find("> .tve_content_inner").removeClass("tve_left tve_right tve_center").addClass(d.replace(/CC/,""));break;case"table":var a="tve_align_left tve_align_center tve_align_right tve_align_justify";if(d.match(new RegExp("valign"))){a="tve_valign_top tve_valign_middle tve_valign_bottom"}b.find("th,td").removeClass(a).addClass(d.replace(/_table/,""));break;case"table_cell":var a="tve_align_left tve_align_center tve_align_right tve_align_justify";if(d.match(new RegExp("valign"))){a="tve_valign_top tve_valign_middle tve_valign_bottom"}b.removeClass(a).addClass(d);break;case"rating":b.children(".tve_rating_stars").removeClass("tve_leftBtn tve_centerBtn tve_rightBtn").addClass(d);break;case"lead_generation":b.removeClass("tve_leftBtn tve_centerBtn tve_rightBtn tve_fullwidthBtn").addClass(d);if(d==="tve_fullwidthBtn"){var c=jQuery("#"+element_type+"_menu");$targetInput=c.find(".tve_slider_config").find(c.find(".tve_slider_config").attr("data-input-selector"));$targetInput.val(b.parent().width()).change()}break;default:b.removeClass("tve_leftBtn tve_centerBtn tve_rightBtn tve_fullwidthBtn").addClass(d);break}}function tve_change_shortcode_colour(c,a){element_type=get_shortcode_type_from_edit_mode(a);if(element_type=="text"){var b=this.parents(".tve_highlight_control").length?"background":"foreground";tve_change_colour(this,b)}else{if(element_type==="tw_qs"){tve_remove_custom_colours(a)}else{shortcode=get_element_from_wrapper(a,element_type);shortcode.removeClass(colours_class_selector).addClass(c);tve_remove_custom_colours(a);tve_after_apply_custom_color(shortcode,c)}}window.last_colour_used=c;TVE_Content_Builder.colors.refresh()}function get_element_from_wrapper(a,b){switch(b){case"button":return jQuery(a).find(".tve_btn");case"contentbox":return jQuery(a).find(".tve_cb");case"guarantee":return jQuery(a).find(".tve_fg");case"calltoaction":return jQuery(a).find(".tve_ca, .tve_btn");case"testimonial":return jQuery(a).find(".tve_ts");case"bullets":return jQuery(a).find(".tve_ul");case"tabs":return jQuery(a).find("> .tve_scT");case"pricingtable":return a;case"table":return a.find("table.tve_table").first();case"content_container":return a.find("> .tve_content_inner");case"lightbox":return a.parents(".tve_p_lb_content").first();case"icon":return a.find("span.tve_sc_icon").first()}return a}function get_shortcode_type_from_edit_mode(a){if(a.hasClass("thrv_button_shortcode")){return"button"}else{if(a.hasClass("thrv_contentbox_shortcode")){return"contentbox"}else{if(a.hasClass("thrv_contents_table")){return"contents_table"}else{if(a.hasClass("thrv_guarantee_shortcode")){return"guarantee"}else{if(a.hasClass("thrv_calltoaction_shortcode")){return"calltoaction"}else{if(a.hasClass("thrv_testimonial_shortcode")){return"testimonial"}else{if(a.hasClass("thrv_bullets_shortcode")){return"bullets"}else{if(a.hasClass("thrv_tabs_shortcode")){return"tabs"}else{if(a.hasClass("thrv_toggle_shortcode")){return"toggle"}else{if(a.hasClass("tve_prt")){return"pricingtable"}else{if(a.hasClass("thrv_content_container_shortcode")){return"content_container"}else{if(a.hasClass("thrv_table")){return"table"}else{if(a.hasClass("tve_table_cell")){return"table_cell"}else{if(a.hasClass("tve_image")){return"image"}else{if(a.is(text_elements)){return"text"}else{if(a.hasClass("thrv_star_rating")){return"rating"}else{if(a.hasClass("thrv_tw_qs")){return"tw_qs"}else{if(a.hasClass("thrv_lead_generation")){return"lead_generation"}else{if(a.hasClass("thrv_widget")){return"widget"}else{if(a.hasClass("tve_p_lb_control")){return"lightbox"}else{if(a.hasClass("thrv_icon")){return"icon"}}}}}}}}}}}}}}}}}}}}}}function tve_wrap_element_tags(b,a,d){var c=jQuery(a+b.html()+d);b.replaceWith(c);TVE_Content_Builder.drag.bind_draggable(c)}function tve_save_post(e,j,f){var b=filter_content_pre_save();var c=tve_transform_more_tags();var a=tve_extract_stylesheet_rules();var h=window.tve_custom_colours;var d=tve_get_custom_css();jQuery("#pre_save_filter_wrapper").html("");var g={action:"tve_save_post",tve_content:b,tve_content_more:c,post_id:tve_path_params.post_id,security:tve_path_params.tve_ajax_nonce,update:e,inline_rules:a,custom_colours:h,tve_custom_css:d,tve_landing_page:tve_path_params.landing_page?tve_path_params.landing_page:"",custom_font_classes:[],tve_globals:{},tve_global_scripts:tve_path_params.tve_global_scripts?tve_path_params.tve_global_scripts:{},has_icons:0};jQuery.each(tve_path_params.tve_globals,function(m,l){if(m){g.tve_globals[m]=l}});if(custom_font_classes){jQuery.each(custom_font_classes.split(" "),function(l,k){if(TVE_Editor_Page.editor.find("."+k).length){g.custom_font_classes.push(k)}})}if(typeof f!=="undefined"){jQuery.each(f,function(m,l){g[m]=l})}if(jQuery(".tve_sc_icon:not(.tve_sc_text)").length){g.has_icons=1}if(jQuery(".tve_post_grid_masonry").length){g.tve_has_masonry=1}TVE_Editor_Page.overlay();jQuery.post(tve_path_params.ajax_url,g,function(k){if(e){tve_add_notification("All changes saved!")}if(typeof j==="function"){j()}else{TVE_Editor_Page.overlay("close")}});tve_undoManager.clear()}function tve_save_post_extra(b,c,a){if(typeof c==="undefined"){c={}}c.action="tve_save_post";c.custom_action=b;c.post_id=tve_path_params.post_id;c.security=tve_path_params.tve_ajax_nonce;c.tve_globals=tve_path_params.tve_globals;c.tve_global_scripts=tve_path_params.tve_global_scripts;TVE_Editor_Page.overlay();jQuery.post(tve_path_params.ajax_url,c,function(d){if(typeof a==="function"){a(d)}else{TVE_Editor_Page.overlay("close")}})}function tve_change_style_family(c){tve_save_post(false);var a={action:"tve_change_style_family",style_family:c,post_id:tve_path_params.post_id,security:tve_path_params.tve_ajax_nonce};var b=jQuery("#tve_editor").parent();jQuery("#tve_style_family_"+b.attr("id")+"-css").attr("href",tve_path_params.style_families[c]);tve_path_params.tve_loaded_stylesheet=c;b.removeClass("tve_flt tve_clsy tve_min").addClass(tve_path_params.style_classes[c]);jQuery.post(tve_path_params.ajax_url,a,function(d){})}function load_button_values(r,M){var f=jQuery("#"+M+"_menu");switch(M){case"button":handle_custom_classes(r);handle_custom_fonts(r.find("a.tve_btnLink"),f);jQuery("#button_cc_icons").prop("checked",r.find(".thrv_cc_icons").length!=0);f.find(".tve_font_size").val(parseInt(r.find("a.tve_btnLink").css("font-size")));r=get_element_from_wrapper(r,M);jQuery("#buttonText").val(jQuery.trim(r.find("a").text()));jQuery("#buttonLink").val(r.find("a").attr("href"));if(r.find(".tve_btnLink").attr("target")=="_blank"){jQuery("#btn_link_new_window").prop("checked",true)}else{jQuery("#btn_link_new_window").prop("checked",false)}if(r.find(".tve_btnLink").attr("rel")=="nofollow"){jQuery("#btn_nofollow").prop("checked",true)}else{jQuery("#btn_nofollow").prop("checked",false)}for(var J=1;J<=8;J++){if(r.hasClass("tve_btn"+J)){tve_set_selected_dropdown(f.find("li#tve_btn"+J));break}}jQuery.each("tve_smallBtn tve_normalBtn tve_bigBtn tve_hugeBtn".split(" "),function(O,N){if(r.hasClass(N)){tve_set_selected_dropdown(f.find("li#"+N));return false}});jQuery("#tve_icon_button_font_size").val(parseInt(r.find("i").first().css("font-size")));jQuery("#tve_icon_button_font_size_slider").slider("value",parseInt(r.find("i").first().css("font-size")));jQuery("#tve_image_button_size_input").val(parseInt(r.find("i").first().css("width")));jQuery("#tve_button_image_size_slider").slider("value",parseInt(r.find("i").first().css("width")));break;case"calltoaction":jQuery("#call_to_action_url").val(r.find("a.tve_btnLink").attr("href"));if(r.find("a.tve_btnLink").attr("target")=="_blank"){jQuery("#cta_link_new_window").prop("checked",true)}else{jQuery("#cta_link_new_window").prop("checked",false)}if(r.find("a.tve_btnLink").attr("rel")=="nofollow"){jQuery("#cta_nofollow").prop("checked",true)}else{jQuery("#cta_nofollow").prop("checked",false)}break;case"img":var s=r.tve_image();var a=r.css("width"),v=false,G=parseInt(r.css("borderLeftWidth"));if(a){var x=r.closest(".thrv_wrapper").parent().width(),q=parseInt(s.e.css("margin-left")),m=parseInt(s.e.css("margin-right"));x=!isNaN(q)?x-q:x;x=!isNaN(m)?x-m:x;if(a>x){a=x}jQuery("#image_width_input").val(a);jQuery("#tve_img_size_slider").slider("option","max",x).slider("value",parseInt(a))}jQuery("#image_border_width").val(isNaN(G)?"0":G);jQuery("#img_alt_att").val(r.attr("alt"));jQuery("#img_title_att").val(r.attr("title"));handle_custom_classes(r);jQuery.each(border_styles.split(" "),function(O,N){if(r.hasClass(N)){v=true;tve_set_selected_dropdown(f.find("li#"+N));return false}});if(!v){tve_set_selected_dropdown(f.find("li#tve_brdr_none"),true)}jQuery.each(img_styles.split(" "),function(O,N){if(s.hasStyle(N)){tve_set_selected_dropdown(f.find("li#"+N));return false}});if(s.hasStyle("__none__")){tve_set_selected_dropdown(f.find("li.img_style").last())}break;case"text_inline_only":f.find(".tve_font_size").val(parseInt(r.css("font-size")));jQuery(".element_id").val(r.attr("id"));handle_custom_fonts(r,f);break;case"text":f.find(".tve_font_size").val(parseInt(r.css("font-size")));f.find(".element_id").val(r.attr("id"));jQuery.each("p address pre blockquote h1 h2 h3 h4 h5 h6".split(" "),function(O,N){if(r.is(N)){tve_set_selected_dropdown(f.find('li.tve_block_change[data-tag="'+N+'"]'));return false}});handle_custom_classes(r);handle_custom_fonts(r,f);break;case"cc_icons":jQuery(".cc_checkbox").prop("checked",false);r.find(".tve_cc_logo:visible").each(function(){cc_type=jQuery(this).attr("class");cc_type_array=cc_type.split(" ");for(J=0;J<cc_type_array.length;J++){if(cc_type_array[J]!="tve_cc_logo"&&cc_type_array[J]!="tve_no_edit"){card_type=cc_type_array[J].substring(4);jQuery("#"+card_type).prop("checked",true)}}});break;case"pricing_table":handle_custom_classes(r);TVE_Content_Builder.controls.pricing_table.highlight_btn(f.find(".tve_btn_highlight"),r);break;case"table":r=get_element_from_wrapper(r,"table");var G=parseInt(r.css("borderLeftWidth")),D=parseInt(r.find("td,th").first().css("paddingTop")),F=parseInt(r.find("td,th").first().height()),v=false;jQuery("#table_border_width").val(isNaN(G)?"0":G);jQuery("#table_cell_padding").val(isNaN(D)?"5":D);jQuery("#table_outer_border").prop("checked",(r.hasClass("tve_no_border")?false:true));jQuery("#table_inner_border").prop("checked",(r.hasClass("tve_no_inner_border")?false:true));jQuery("#table_row_height").val(isNaN(F)?0:F);jQuery.each(border_styles.split(" "),function(O,N){if(r.hasClass(N)){v=true;tve_set_selected_dropdown(f.find("li#"+N));return false}});if(!v){tve_set_selected_dropdown(f.find("li#tve_brdr_none"),true)}break;case"table_cell":var G=parseInt(r.css("borderLeftWidth")),d=r.width(),p=r.height();jQuery("#table_cell_border_width").val(isNaN(G)?"0":G);jQuery("#table_cell_width").val(d);jQuery("#table_cell_height").val(p);break;case"page_section":jQuery("#tve_page_section_bg_fixed").prop("checked",r.find("> .out.pswr > .in.pdwbg").length?true:false);jQuery("#tve_page_section_auto_height").prop("checked",r.find("> .out.pswr > .in.pdfbg").length?true:false);jQuery("#tve_page_section_tmg").prop("checked",r.find("> .out.tmg").length?true:false);jQuery("#tve_page_section_bmg").prop("checked",r.find("> .out.bmg").length?true:false);break;case"thrive_optin":jQuery("#tve_thrive_optin_text").val(r.tve_thrive_optin().config().text);break;case"content_container":r=get_element_from_wrapper(r,M);var a=parseInt(r.css("width"));if(!isNaN(a)){jQuery("#content_container_width_input").val(a).trigger("change")}break;case"content_reveal":var G=parseInt(r.attr("data-after")),B=jQuery("#content_reveal_menu .content_reveal_after");B.filter(".seconds").val(G%60);B.filter(".minutes").val(Math.floor(G/60)).trigger("change");jQuery("#content_reveal_redirect_url").val(r.attr("data-redirect-url"));break;case"bullets":r=get_element_from_wrapper(r,M);for(var J=1;J<=6;J++){if(r.hasClass("tve_ul"+J)){tve_set_selected_dropdown(f.find("li#tve_ul"+J));break}}break;case"feature_grid":for(var J=1;J<=3;J++){if(r.hasClass("tve_gr"+J)){tve_set_selected_dropdown(f.find("li#tve_gr"+J));break}}break;case"countdown_timer_evergreen":var j=r.tve_countdown_timer_evergreen();f.find("#ct_day").val(j.get("day"));f.find("#ct_hour").val(j.get("hour"));f.find("#ct_min").val(j.get("min"));f.find("#ct_sec").val(j.get("sec"));f.find("#ct_text").val(j.get("text"));f.find("#ct_expday").val(j.get("expday"));f.find("#ct_exphour").val(j.get("exphour"));f.find(".tve_input_translatable").each(function(){var O=jQuery(this),N=r.find(O.data("args")).text();O.val(N)});break;case"countdown_timer":var j=r.tve_countdown_timer();jQuery("#ct_date").val(j.get("date"));jQuery("#ct_hour").val(j.get("hour"));jQuery("#ct_min").val(j.get("min"));jQuery("#ct_text").val(j.get("text"));f.find(".tve_input_translatable").each(function(){var O=jQuery(this),N=r.find(O.data("args")).text();O.val(N)});break;case"thrive_posts_list":var e=r.tve_thrive_posts_list();f.find("#posts_list_no_posts").val(e.config().no_posts);f.find("#posts_list_filter").val(e.config().filter);f.find("#posts_list_category").val(e.config().category);f.find("#posts_list_thumbnails").prop("checked",e.config().thumbnails!="off");break;case"thrive_custom_phone":var e=r.tve_thrive_custom_phone();f.find("#custom_phone_color").val(e.config().color);f.find("#custom_phone_no").val(e.config().phone_no);f.find("#custom_phone_text").val(e.config().phone_text);f.find("#custom_mobile_phone_text").val(e.config().mobile_phone_text);break;case"thrive_custommenu":var e=r.tve_thrive_custom_menus();f.find("#custom_menu_menu").val(e.config().menu);f.find("#custom_menu_thumbnails").prop("checked",e.config().thumbnails!="off");break;case"responsive_video":var g=r.tve_responsive_video();if(typeof g.config("type")==="undefined"){g.set("youtube","type")}f.find("#responsive_video_type").val(g.config("type"));f.find("#responsive_video_url").val(g.config("url"));if(g.config("type")==="youtube"){f.find(".responsive_video_option").css("display","block");f.find("#rv_option_rel").prop("checked",g.config("rel")==="undefined"?false:g.config("rel")==="0");f.find("#rv_option_modestbranding").prop("checked",g.config("modestbranding")==="undefined"?false:g.config("modestbranding")==="1");f.find("#rv_option_controls").prop("checked",g.config("controls")==="undefined"?false:g.config("controls")==="0");f.find("#rv_option_showinfo").prop("checked",g.config("showinfo")==="undefined"?false:g.config("showinfo")==="0");f.find("#rv_option_autoplay").prop("checked",g.config("autoplay")==="undefined"?false:g.config("autoplay")==="1");f.find("#rv_option_fs").prop("checked",g.config("fs")==="undefined"?false:g.config("fs")==="0")}break;case"contents_table":var w=r.tve_contents_table();f.find(".ct_heading").each(function(){var N=jQuery(this);N.prop("checked",w.config("headers").indexOf(N.val())>=0)});f.find("#ct_columns").val(w.config("columns"));var t=parseInt(r.css("min-width"));var z=r.css("max-width");f.find("#ct_min_width").val(t);f.find("#ct_max_width").val(z!=="none"?parseInt(z):z);break;case"tabs":var l=r.tve_tabs().populateTabList();if(l.isVertical()){var a=r.find("ul").width();jQuery("#vtabs_width_input").val(a+"px");jQuery("#s_vtabs_menu_width").slider("value",a)}var c=f.find("li.tve_selected_tab").eq(l.getDefaultSelected());tve_set_selected_dropdown(c,c.length===0);break;case"tw_qs":var b=r.tve_tw_qs();f.find("#qs_tw_via").val(b.config("via"));break;case"rating":var C=r.tve_rating();jQuery("#rating_value").val(C.get("value"));jQuery("#rating_max").val(C.get("max"));break;case"lead_generation":tve_set_selected_dropdown(r.is(".thrv_lead_generation_horizontal")?f.find("#thrv_lead_generation_horizontal"):f.find("#thrv_lead_generation_vertical"));f.find("#lead_generation_button_text").val(r.find("button").text());var L=f.find("#lead_generation_form_target");var h=r.tve_lead_generation();L.prop("checked",h.config("form-target")===L.val());var a=r.css("width");if(a){var x=r.closest(".thrv_wrapper").parent().width();f.find("#lead_generation_width_input").val(a);jQuery("#tve_lead_generation_size_slider").slider("option","max",x).slider("value",parseInt(a))}break;case"contentbox":handle_custom_classes(r);f.find(".element_id").val(r.attr("id"));var E=parseInt(r.find(".tve_cb").css("border-top-left-radius"));E=isNaN(E)?0:E;f.find("#border_radius_input").val(E);f.find("#tve_border_radius_slider").slider("value",E);break;case"lightbox":r=get_element_from_wrapper(r,M);var K=parseFloat(jQuery(".tve_p_lb_overlay").css("opacity")),v=false,G=parseInt(r.css("borderLeftWidth")),k=parseInt(r.css("max-width")),u=parseInt(r.find("#tve-p-scroller").css("max-height"));K=isNaN(K)?80:K*100;jQuery("#lightbox_opacity_input").val(K).trigger("change");jQuery("#lightbox_border_width").val(isNaN(G)?"0":G);jQuery("#lightbox_max_width").val(isNaN(k)?"0":k);jQuery("#lightbox_max_height").val(isNaN(u)?"0":u);jQuery.each(border_styles.split(" "),function(O,N){if(r.hasClass(N)){v=true;tve_set_selected_dropdown(f.find("li#"+N));return false}});if(!v){tve_set_selected_dropdown(f.find("li#tve_brdr_none"),true)}break;case"landing_page":jQuery("#tve_lp_bg_fixed").prop("checked",jQuery("body").css("background-attachment")=="fixed");jQuery("#tve_strip_css").prop("checked",tve_path_params.tve_globals.do_not_strip_css=="1"?true:false);break;case"landing_page_content":jQuery("#tve_lp_bg_fixed").prop("checked",r.css("background-attachment")=="fixed");jQuery("#tve_lp_auto_height").prop("checked",r.hasClass("tve_fh"));if(TVE_Content_Builder.landing_page&&TVE_Content_Builder.landing_page.content_width_selector){var A=jQuery(TVE_Content_Builder.landing_page.content_width_selector());var a=parseInt(A.css("max-width"));if(!isNaN(a)){jQuery("#lp_content_width").val(a).trigger("change")}}var E=parseInt(r.css("border-top-left-radius"));E=isNaN(E)?0:E;f.find("#border_radius_input").val(E);f.find("#tve_border_radius_slider").slider("value",E);break;case"icon":r=get_element_from_wrapper(r,M);if(r.hasClass("tve_sc_text")){jQuery("#tve_icon_text").val(r.text())}var y=parseInt(r.css("font-size")),v=false,E=parseInt(r.css("border-top-left-radius")),G=parseInt(r.css("borderLeftWidth")),I=parseInt(r.css("paddingTop"));I=isNaN(I)?0:I;y=isNaN(y)?0:y;E=isNaN(E)?0:E;G=isNaN(G)?0:G;if(G&&!r.data("border-width")){r.parent().css("border-width",G+"px");r.css("border-width","");r.data("border-width",true)}if(r.parent().css("borderLeftWidth")){G=parseInt(r.parent().css("borderLeftWidth"))}if(r.tve_color_selector()&&r.css("border-top-color")&&!r.data("border-color")){r.parent().css("border-color",r.css("border-top-color"));tve_remove_css_rule(r.tve_color_selector(),"border-color");r.data("border-color",true)}if(y){var x=r.closest(".thrv_wrapper").parent().width();jQuery("#icon_size_input").val(y);jQuery("#tve_icon_size_slider").slider("option","max",x).slider("value",y);jQuery("#icon_padding_input").val(I).trigger("change");f.find("#border_radius_input").val(E).trigger("change")}jQuery.each(["margin-top","margin-right","margin-bottom","margin-left"],function(P,N){var O=parseInt(r.css(N));if(!isNaN(O)){r.parent().css(N,O+"px")}r.css(N,"")});jQuery("#icon_border_width").val(isNaN(G)?"0":G);handle_custom_classes(r.parents(".thrv_icon").first());jQuery.each(border_styles.split(" "),function(O,N){if(r.hasClass(N)){v=true;r.removeClass(N);r.parent().addClass(N);tve_set_selected_dropdown(f.find("li#"+N));return false}if(r.parent().hasClass(N)){v=true;tve_set_selected_dropdown(f.find("li#"+N));return false}});if(!v){tve_set_selected_dropdown(f.find("li#tve_brdr_none"),true)}break}if(r.is(".edit_mode")){r=get_element_from_wrapper(r,M)}f.find("input.margin-control").each(function(){var Q=jQuery(this),O,P=r,N=Q.parents(".tve_option_separator").find(".css-selector").val();if(N&&N.indexOf("_parent::")===0){P=r.parents(N.replace("_parent::","")).first()}else{if(N){P=r.find(N)}}O=parseInt(P.css(Q.attr("data-target")));isNaN(O)&&(O=0);this.value=O});f.find("input.padding-control").each(function(){var Q=jQuery(this),O,P=r,N=Q.parents(".tve_option_separator").find(".css-padding-selector").val();if(N&&N.indexOf("_parent::")===0){P=r.parents(N.replace("_parent::","")).first()}else{if(N){P=r.find(N)}}O=parseInt(P.css(Q.attr("data-target")));isNaN(O)&&(O=0);this.value=O});if(f.find("#tve_line_height").length){var n=r.css("line-height"),H=n.indexOf("px")===-1?"em":"px",o=H==="px"?parseInt(n):parseFloat(n);if(isNaN(o)){o=20;H="px"}f.find("#tve_line_height").val(o);tve_set_selected_dropdown(f.find("li#tve_line_height_"+H))}if(f.find(".tve_shadow_control")){TVE_Content_Builder.controls.shadow.on_menu_show(f,r)}}function handle_custom_classes(a){if(!a.length){return}class_list=a.attr("class");class_list_array=class_list.split(" ");var b=new Array();for(i=0;i<class_list_array.length;i++){if(class_list_array[i].indexOf("thrv_")==-1&&class_list_array[i].indexOf("tve_")==-1&&thrv_custom_classes.indexOf(class_list_array[i])==-1&&custom_font_classes.indexOf(class_list_array[i])===-1){b.push(class_list_array[i])}}jQuery(".element_class").val(b.join(" "))}function handle_custom_fonts(a,b){var c=false;if(custom_font_classes){jQuery.each(custom_font_classes.split(" "),function(e,d){if(a.hasClass(d)){c=true;tve_set_selected_dropdown(b.find('li.tve_font_selector[data-cls="'+d+'"]'))}})}if(c===false){tve_set_selected_dropdown(b.find("li.tve_font_selector").first(),true)}}function tve_transform_more_tags(){jQuery("#pre_save_filter_wrapper .tve_more_tag").replaceWith("<!--tvemore-->");return jQuery("#pre_save_filter_wrapper").html()}function filter_content_pre_save(b){if(typeof b==="undefined"){b={}}var a=jQuery("#pre_save_filter_wrapper"),c=TVE_Editor_Page.editor.children(".tve_content_save").length?TVE_Editor_Page.editor.children(".tve_content_save"):TVE_Editor_Page.editor;a.html(c.html());a.find(".edit_mode, .tve_merge_cells, .tve_merge_selected").removeClass("edit_mode tve_merge_cells tve_merge_selected");a.find(".tve_faqC").css("display","none");a.find(".tve_oFaq").removeClass("tve_oFaq");a.find(".tve_dropzone").remove();a.find("."+custom_html_placeholder_class).remove();a.find("*[contenteditable='true']").attr("contenteditable","false");a.html(tve_multilineTrim(a.html()));a.find(".thrive-shortcode-html").remove();a.find(".init_done").removeClass("init_done");if(!b.keep_wp_shortcodes){a.find(".tve_shortcode_rendered").remove()}a.find(".tve_draggable").removeClass("tve_draggable");a.find('*[draggable="true"]').removeAttr("draggable");a.find(".tve_widget_container").remove();a.find(".tve_post_grid_wrapper").remove();return a.html()}function hide_sub_menu(){jQuery(".active_sub_menu").trigger("tve.hide_sub_menu").hide().parent().css("bottom","");tve_remove_text_boundaries()}function tve_open_lightbox(g){var d=g.attr("data-lb")?g.attr("data-lb"):g.attr("id"),f=g.hasClass("tve_lb_small"),e=jQuery.param({}),c=jQuery(".edit_mode");if(typeof g!=="undefined"&&g){e=g.find("input").serialize()}if(d=="lb_shortcode"){return tve_show_tinymce_popup("")}if(d=="tve_event_manager"){return TVE_Content_Builder.event_manager.open(jQuery(".edit_mode"))}if(d=="lb_icon"){var b={post_id:tve_path_params.post_id};if(c.length){var a=c.find(".tve_sc_icon");b.current_icon=a.length?a.attr("data-tve-icon"):""}e+=(e?"&":"")+jQuery.param(b)}if(d=="lb_post_grid"&&jQuery(".tve_active_lightbox").find(".thrive-shortcode-config").length){e=jQuery(".tve_active_lightbox").tve_post_grid().getConfig()}if(g.attr("data-load")){TVE_Editor_Page.overlay()}jQuery.post(tve_path_params.cpanel_dir+"/"+d+".php",e,function(h){load_lightbox_content(h,f);tve_populate_lightbox(d);var j=jQuery(".tve_lightbox_frame");j.find(".tve_lightbox_buttons").hide();j.find(".tve_lightbox_content").css("padding-bottom","20px");if(d==="lb_lead_generation_code"){jQuery("<div>"+h+"</div>").tve_lead_generation()}else{if(d==="lb_widgets"){var k=jQuery(".thrv_widget.tve_active_lightbox");jQuery("<div>"+h+"</div>").tve_widgets({wrapper:k})}}if(d!=="lb_landing_pages"&&d!=="lb_lead_generation_code"){j.find(".tve_lightbox_buttons").show()}if(g.attr("data-btn-text")){j.find(".tve_save_lightbox").val(g.attr("data-btn-text"))}else{j.find(".tve_save_lightbox").val("Save")}show_lightbox();TVE_Editor_Page.overlay(true)})}function load_lightbox_content(b,a){jQuery("#tve_lightbox_content").html(b);if(a){jQuery("#tve_lightbox_frame, #tve_lightbox_overlay").addClass("tve_link_lightbox")}else{jQuery("#tve_lightbox_frame, #tve_lightbox_overlay").removeClass("tve_link_lightbox")}}function show_lightbox(){jQuery(".tve_lightbox_overlay").show();jQuery(".tve_lightbox_frame").show()}function tve_get_lightbox_options(){user_options=new Object();jQuery(".tve_lightbox_frame .tve_lightbox_content input, .tve_lightbox_frame .tve_lightbox_content select, .tve_lightbox_frame .tve_lightbox_content textarea").each(function(){var a=jQuery(this);if(a.attr("name")===undefined){return}if(a.attr("type")=="checkbox"){checked=tve_is_checked(a);user_options[a.attr("name")]=checked}else{user_options[a.attr("name")]=a.val()}});return user_options}function tve_populate_lightbox(a){switch(a){case"lb_full_html":page_content=filter_content_pre_save({keep_wp_shortcodes:true});jQuery("textarea[name='tve_full_html']").val(tve_revert_script_tags(page_content));break;case"lb_image_link":element=jQuery(".edit_mode");if(element.hasClass("thrv_icon")){element=element.find("span.tve_sc_icon").first()}if(jQuery(element).parent().is("a")){jQuery("#lb_link_location").val(jQuery(element).parent().attr("href"));if(jQuery(element).parent().attr("target")=="_blank"){jQuery("#lb_link_target").prop("checked",true)}if(jQuery(element).parent().attr("rel")=="nofollow"){jQuery("#lb_no_follow").prop("checked",true)}}break;case"lb_custom_html":element=jQuery(".edit_mode");if(element.length==0){element=jQuery(".tve_active_lightbox")}element.addClass("tve_active_lightbox");element.find(".tve_iframe_cover").remove();jQuery("#tve_custom_html").val(tve_revert_script_tags(element.html()));break;case"lb_custom_css":jQuery("textarea[name=tve_custom_css]").val(tve_get_custom_css(true));break;case"lb_global_scripts":jQuery("#tve_global_scripts_head").val(tve_path_params.tve_global_scripts.head?tve_path_params.tve_global_scripts.head:"");jQuery("#tve_global_scripts_footer").val(tve_path_params.tve_global_scripts.footer?tve_path_params.tve_global_scripts.footer:"");break;case"lb_post_grid":jQuery(".tve_post_grid_tabs_container").tve_post_grid().sortable().autocomplete();break}}function tve_handle_lightbox_options(d){switch(d.tve_lb_type){case"custom_html":var k=jQuery(".tve_active_lightbox");var b=tve_convert_script_tags(d.tve_custom_html);k.html(b).removeClass(custom_html_placeholder_class+" code_placeholder").addClass("thrv_custom_html_shortcode");if(k.height()===0&&k.find("img").length===0){k.append(custom_html_default_html)}else{k.find("."+custom_html_placeholder_class).remove();if(k.find("iframe").length){k.append(jQuery('<div class="tve_iframe_cover"></div>'))}}break;case"tve_post_grid":var m=jQuery(".tve_sortable_layout").sortable("toArray",{attribute:"data-layout"});d.layout=m;jQuery(".tve_active_lightbox, .edit_mode").tve_post_grid(d).display();break;case"tve_full_html":var k=TVE_Editor_Page.editor.children(".tve_content_save").length?TVE_Editor_Page.editor.children(".tve_content_save"):TVE_Editor_Page.editor;k.html(tve_convert_script_tags(d.tve_full_html));TVE_Content_Builder.drag.refresh(true);break;case"tve_google_map":google_map_code=d.tve_embed_code;jQuery(".tve_active_lightbox").replaceWith("<div class='tve-flexible-container thrv_wrapper'>"+d.tve_embed_code+"</div>");break;case"text_link":tve_add_hyperlink(d.lb_link,d.lb_link_target,d.lb_link_name,d.lb_no_follow);break;case"image_link":tve_add_image_hyperlink(d.lb_link,d.lb_link_target,d.lb_no_follow);break;case"user_template":tve_add_user_template(jQuery("#template_name").val(),d);break;case"tve_custom_css":tve_add_custom_css(d.tve_custom_css);break;case"tve_table":var n=parseInt(d.tve_table_rows),j=parseInt(d.tve_table_cols);jQuery("#tve_table_rows_number,#tve_table_cols_number").removeClass("tve_field_error");if(isNaN(n)||n<=0||n>15){jQuery("#tve_table_rows_number").addClass("tve_field_error");return false}if(isNaN(j)||j<=0||j>15){jQuery("#tve_table_cols_number").addClass("tve_field_error");return false}d.tve_table_rows=n;d.tve_table_cols=j;TVE_Content_Builder.drag.insert(tve_build_table(d),jQuery(".tve_active_lightbox").removeClass("table_placeholder"),true);break;case"shortcode":var k=jQuery(".tve_active_lightbox"),a=k.find(".tve_shortcode_raw"),l=k.find(".tve_shortcode_rendered");if(a.length===0){k.empty();a=jQuery('<div class="tve_shortcode_raw" style="display: none"></div>').appendTo(k);l=jQuery('<div class="tve_shortcode_rendered"></div>').appendTo(k)}tve_hide_tinymce_popup();TVE_Editor_Page.overlay();var h={action:"tve_render_shortcode",security:tve_path_params.tve_ajax_nonce,content:tve_get_tinymce_content()};a.html("___TVE_SHORTCODE_RAW__"+h.content+"__TVE_SHORTCODE_RAW___");jQuery.post(tve_path_params.front_ajax_url,h,function(o){k.removeClass("code_placeholder");l.html(o);TVE_Editor_Page.overlay("close")});break;case"widgets":var k=jQuery(".tve_active_lightbox"),g=k.tve_widgets({wrapper:k});g.config.update(jQuery(".tve_widgets_list").val(),"widget");g.config.update(d,"options");g.displayWidget();break;case"sc_icon":var e=jQuery(".icomoon-icon.tve_selected"),c=jQuery(".tve_active_lightbox"),f=jQuery(".edit_mode");if(e.length==0){tve_add_notification("You have to select an icon",true);return false}if(f.length){if(f.hasClass("thrv_button_shortcode")){f=f.find(".tve_left i").addClass("tve_sc_icon").css("width","").css("background-image","none")}else{f=f.find("span.tve_sc_icon")}f.attr("class","tve_sc_icon").addClass(e.attr("data-cls"));f.attr("data-tve-icon",e.attr("data-cls"));return true}d.icon_class=e.attr("data-cls");jQuery.post(tve_path_params.shortcodes_dir+"sc_icon.php",d,function(o){TVE_Content_Builder.drag.insert(o,c)});break;case"global_scripts":tve_path_params.tve_global_scripts.head=d.head;tve_path_params.tve_global_scripts.footer=d.footer;break}return true}function tve_multilineTrim(a){if(a=="undefined"){return false}return a.split("\n").map(jQuery.trim).filter(function(b){return b!=""}).join("\n")}function tve_add_image_hyperlink(d,f,e){var c=jQuery(".edit_mode"),b=f?"_blank":"_self",a;if(c.hasClass("thrv_icon")){c=c.find("span.tve_sc_icon").first()}a=c.parent();if(!a.is("a")){c.wrapAll(jQuery('<a href="'+d+'"></a>'));a=c.parent()}a.attr({href:d,target:b,rel:e?"nofollow":""});jQuery(".tve_link_btns").show()}function tve_add_hyperlink(c,e,b,f){rangy.restoreSelection(window.linkSel);var a=document.createElement("a");a.href=c;if(e){a.target="_blank"}if(b){a.name=b}if(f){a.setAttribute("rel","nofollow")}var d=rangy.getSelection();if(!d.toString().length){a.innerHTML="Click to replace anchor text"}tve_surroundSelectedText(a);rangy.removeMarkers(window.linkSel)}function tve_surroundSelectedText(c){var d,b;if(window.getSelection){d=window.getSelection();if(d.getRangeAt&&d.rangeCount){b=d.getRangeAt(0);c.appendChild(document.createTextNode(b.toString()));b.deleteContents();b.insertNode(c);b=b.cloneRange();b.setStartAfter(c);b.collapse(true)}}else{if(document.selection&&document.selection.type!="Control"){var a=document.selection.createRange();c.appendChild(document.createTextNode(a.text));a.pasteHTML(c.outerHTML)}}}function tve_add_user_template(g,a){var e,h;if(a.element){var b=jQuery(".tve_active_lightbox"),d=b.clone();d.find("edit_mode, .tve_active_lightbox").removeClass("edit_mode tve_active_lightbox");var f=b.tve_color_selector()?[b.tve_color_selector()]:[];b.find("[data-tve-custom-colour]").each(function(){f.push(jQuery(this).tve_color_selector())});e=jQuery("<div></div>").append(d.removeClass("edit_mode tve_active_lightbox active_delete active_highlight active_duplicate")).html();h=tve_extract_stylesheet_rules_filtered(f)}else{e=TVE_Editor_Page.editor.html();h=tve_extract_stylesheet_rules()}g=encodeURIComponent(g);var c={action:"tve_save_user_template",template_name:g,template_content:e,dataType:"json",security:tve_path_params.tve_ajax_nonce,custom_css:h};TVE_Editor_Page.overlay();jQuery.post(tve_path_params.ajax_url,c,function(j){TVE_Editor_Page.overlay(true);if(!j.success){tve_add_notification(j.error)}else{var k=jQuery('<li id="tve_user_template" class="cp_draggable user_template_item tve_clearfix" draggable="true"><span class="tve_left">'+decodeURIComponent(j.new_template_added)+'</span><span class="tve_icon tve_icon-51 remove_user_template tve_right"></span></li>');jQuery("#user_template_list").append(k).find(".hide-on-tpl-save").hide();tve_add_notification("New template added!");TVE_Content_Builder.drag.make_draggable(k[0])}},"json")}function tve_is_checked(a){if(jQuery(a).prop("checked")){return true}else{return false}}function check_image_caption(a){if(jQuery(a).parents(".tve_image_caption").length!=0){return true}else{return false}}function tve_menu_color(a){if(a=="light"){jQuery("#tve_cpanel").removeClass("tve_is_dark");jQuery(".tve_cpanel_onpage").removeClass("tve_is_dark")}else{jQuery("#tve_cpanel").addClass("tve_is_dark");jQuery(".tve_cpanel_onpage").addClass("tve_is_dark")}hide_sub_menu();tve_save_cp_config("color",a)}function tve_menu_position(a){if(a=="right"){jQuery("#tve_cpanel,body").removeClass("tve_cpanelFlip");jQuery(".tve_wrap_inner").removeClass("tve_is_flipped")}else{jQuery("#tve_cpanel,body").addClass("tve_cpanelFlip");jQuery(".tve_wrap_inner").addClass("tve_is_flipped")}hide_sub_menu();tve_save_cp_config("position",a)}function tve_save_cp_config(a,c){var b={action:"tve_editor_display_config",attribute:a,value:c,security:tve_path_params.tve_ajax_nonce};jQuery.post(tve_path_params.ajax_url,b,function(d){})}function tve_change_colour(f,d){if(typeof d==="undefined"){d="foreground"}var e=f.find("a").css("background-color"),b=rangy.getSelection(),a=d=="background"?"backgroundColor":"color",c=d=="background"?"BackColor":"ForeColor";if(!b.toString().length){jQuery(".edit_mode font").contents().unwrap();jQuery(".edit_mode").css(a,rgbToHex(e))}else{document.execCommand(c,false,rgbToHex(e));b.removeAllRanges()}}function rgbToHex(c){if(c.substr(0,1)==="#"){return c}var f=/(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/i.exec(c),e=parseInt(f[2],10).toString(16),d=parseInt(f[3],10).toString(16),a=parseInt(f[4],10).toString(16);return"#"+((e.length==1?"0"+e:e)+(d.length==1?"0"+d:d)+(a.length==1?"0"+a:a))}function tve_remove_text_boundaries(){if(window.textselection){rangy.removeMarkers(window.textselection);window.textselection=null}}function tve_check_submenu_position(c){var b=c.offset();if(b==undefined){return false}var d=jQuery("body").outerHeight(),a=b.top+c.parent().outerHeight();if(d<600){return}if(a>=d){c.parent().css({top:"",bottom:"30px"})}b=c.offset();if(b.top<32){c.parent().css({top:"30px",bottom:""})}}function tve_init_sliders(){var b={css_width:{beforeSlide:function(c,d,f,e){if(f.is("#tve_icon_button_font_size")&&d.length===0){if(typeof tve_timer=="undefined"){tve_timer=setTimeout(function(){tve_add_notification('You are trying to change the size of an icon, however the button currently contains an image. Click on the "Use Image" button to modify the size',true,5000);tve_timer=undefined},500)}return false}return true},onSlide:function(c,d,f,e){f.val(e);this._setValues(e+c.unit,d,c.cssProp)},onInputChange:function(d,e,g,f){var c=parseInt(g.val());c=isNaN(c)?0:c;if(c<d.min){c=d.min}else{if(c>d.max){c=d.max}}g.val(c);f.slider("value",c);this._setValues(parseInt(g.val())+"px",e,d.cssProp)},_setValues:function(d,c,e){if(c.is(".tve_content_inner")){c.css("max-width","")}c.css(e,d);if(check_image_caption(c)){c.parents(".tve_image_caption").first().css(e,d)}}},content_reveal:{beforeSlide:function(c,d,f,e){return true},onSlide:function(c,d,f,e){d.attr("data-after",e);f.filter(".seconds").val(e%60);f.filter(".minutes").val(Math.floor(e/60))},onInputChange:function(d,f,j,h){var g=parseInt(j.filter(".seconds").val()),e=parseInt(j.filter(".minutes").val());g=isNaN(g)?0:g;e=isNaN(e)?0:e;var c=e*60+g;c=c>d.max?d.max:(c<d.min?d.min:c);this.onSlide(d,f,j,c);h.slider("value",c)}},css_opacity:{beforeSlide:function(c,d,f,e){return true},onSlide:function(c,d,f,e){f.val(e);this._setValues(e,d,c.cssProp)},onInputChange:function(d,e,g,f){var c=parseFloat(g.val());c=isNaN(c)?0:c;if(c<d.min){c=d.min}else{if(c>d.max){c=d.max}}g.val(c);f.slider("value",c);this._setValues(parseFloat(g.val()),e,d.cssProp)},_setValues:function(d,c,e){var f=parseFloat(d/100);c.css(e,f);if(c.hasClass("tve_p_lb_overlay")){tve_path_params.tve_globals.l_oo=f}}},void_handler:{beforeSlide:function(){return false}}},a={tabs:function(c,d){c.parent().css("padding-left",d+"px")},icon:function(d,e){var c=parseInt(d.parent().css("border-top-width"));c=isNaN(c)?0:c;if(e==0){d.parent().css("border-radius","0px")}else{d.parent().css("border-radius",(e+c)+"px")}}};jQuery(".tve_slider_config").each(function(){var g=jQuery(this),h=g.find(".tve_slider_element"),d={min:parseInt(g.attr("data-min-value")),step:g.attr("data-step"),val:g.attr("data-value"),max:g.attr("data-max-value"),cssProp:g.attr("data-property")?g.attr("data-property"):"width",isChild:g.attr("data-no-child")?false:true,unit:g.attr("data-unit")?g.attr("data-unit"):"px"},e=g.attr("data-handler")?g.attr("data-handler"):"css_width",c=g.attr("data-selector")?g.attr("data-selector"):false,j=g.attr("data-callback"),f=g.find(g.attr("data-input-selector"));if(d.max==="available"){d.max=TVE_Editor_Page.editor.width()}if(j&&j.indexOf("function:")===0){j=tve_parse_ctrl_string(j,true)}else{if(j&&typeof a[j]==="function"){j=[a,a[j]]}else{j=false}}h.slider({value:d.val,min:d.min,max:d.max,step:d.step?parseInt(d.step):1,slide:function(m,n){var k;if(c&&c.indexOf("function:")===0){var l=tve_parse_ctrl_string(c);if(l){k=jQuery(l())}}else{k=d.isChild?(c?jQuery(".edit_mode").find(c):jQuery(".edit_mode")):jQuery(c)}if(b[e].beforeSlide(d,k,f,n.value)){b[e].onSlide(d,k,f,n.value)}j&&j.length>1&&j[1].call(j[0],k,n.value)}});f.change(function(){if(!jQuery(".edit_mode").length){return}var k;if(c&&c.indexOf("function:")===0){var l=tve_parse_ctrl_string(c);if(l){k=jQuery(l())}}else{k=d.isChild?(c?jQuery(".edit_mode").find(c):jQuery(".edit_mode")):jQuery(c)}b[e].onInputChange(d,k,f,h);j&&j.length>1&&j[1].call(j[0],k,parseInt(f.val()))}).change()})}function tve_add_custom_css(b){var a=jQuery("style#tve_head_custom_css");if(a.length===0){a=jQuery('<style type="text/css" id="tve_head_custom_css"></style>').appendTo(jQuery("head"))}a.text(b)}function tve_get_custom_css(b){var a=jQuery("style#tve_head_custom_css");if(a.length===0){return(typeof b!=="undefined"&&b)?"/** Insert your custom CSS rules here. **/":""}return a.text()}function tve_convert_script_tags(b){var a=jQuery('<div class="tve_escaped_js">'+b+"</div>");if(a.find("script").length===0){return a.html()}a.find("script").each(function(){var c=jQuery(this),d="[tcb-script";var e=jQuery('<code class="tve_js_placeholder"></code>');jQuery.each(this.attributes,function(){d+=" "+this.name+'="'+this.value+'"'});d+="]"+c.text()+"[/tcb-script]";e.text(d);c.replaceWith(e)});return a.html()}function tve_revert_script_tags(b){if(!jQuery.trim(b)){return""}var a=jQuery('<div class="tve_escaped_js">'+b+"</div>");a.find(".tve_custom_html_placeholder,.tve_click").remove();if(a.find("code.tve_js_placeholder").length===0){return jQuery.trim(a.html())}a.find("code.tve_js_placeholder").each(function(){var d=jQuery(this),c=new RegExp("^\\[tcb-script([^\\]]*?)\\]([\\s\\S]*?)\\[/tcb-script\\]$","g"),e=d.text().replace(c,"<script$1>$2<\/script>");var f=jQuery(e);f.removeAttr("class className");d.replaceWith(f)});return jQuery.trim(a.html())}function tve_build_table_row(c,e){var b='<tr class="tve_table_row">',f=c==1?"th":"td",d=c==1?"Header":"Cell";if(c>1){c--}for(var a=1;a<=e;a++){b+="<"+f+' class="tve_table_cell"><p> '+d+" "+c+" / "+a+"</p></"+f+">"}b+="</tr>";return b}function tve_build_table(a){var c='<table data-rows="'+a.tve_table_rows+'" data-cols="'+a.tve_table_cols+'" class="tve_table tve_no_inner_border tve_no_border tve_table_'+a.tve_table_style+'">';c+="<thead>"+tve_build_table_row(1,a.tve_table_cols)+"</thead>";c+="<tbody>";for(var b=2;b<=a.tve_table_rows;b++){c+=tve_build_table_row(b,a.tve_table_cols)}c+="</tbody></table>";return c}function tve_event_change(b,c,j,u){c=get_element_from_wrapper(c,j);var q=b.attr("data-size")?true:false,m=b.val(),h=b.attr("id"),v=b.attr("data-suffix")?b.attr("data-suffix"):"",p=b.attr("data-css-property"),o=b.is(":checked");if(q){m=parseFloat(m);if(isNaN(m)){m=0}}if((j==="text"||j==="text_inline_only"||j==="button")&&b.is(".tve_font_size")){if(isNaN(b.val())){tve_add_notification("Only numbers are accepted !",true,4000);return}if(parseFloat(b.val())>200||parseFloat(b.val())<6){tve_add_notification("Font size should be between 6 and 200 pixels !",true,4000);return}rangy.restoreSelection(window.textSel);var s=rangy.getSelection();if(s.toString().length){var t=document.createElement("span");t.style.fontSize=b.val()+"px";t.className="tve_custom_font_size";tve_surroundSelectedText(t)}else{if(j==="button"){c.find("a.tve_btnLink").css("font-size",b.val()+"px").css("line-height",b.val()+"px")}else{if(c.is("li")){c.parent("ul").css("font-size",b.val()+"px")}else{c.css("font-size",b.val()+"px")}}}}var a=TVE_Editor_Page.editor.width();switch(h){case"table_border_width":if(m>a/c.tve_cols()/4){m=parseInt(a/c.tve_cols()/4);b.val(m)}c.css("border-width",m+""+v);c.find("> tbody > tr > td,> thead > tr > th").css("border-width",m+""+v);break;case"image_border_width":c.css("border-width",m+""+v);break;case"table_cell_padding":if(m>a/c.tve_cols()/2){m=parseInt(a/c.tve_cols()/2);b.val(m)}c.find("> tbody > tr > td,> thead > tr > th").css("padding",m+""+v);break;case"table_cell_border_width":c.css("border-width",m+v);jQuery("input#table_inner_border").prop("checked",true).trigger("change");break;case"table_cell_width":var f=parseInt(c.index())+1;c.parents(".tve_table").first().find("> tbody > tr > td:nth-child("+f+"), > thead > tr > th:nth-child("+f+")").css("width","");c.css("width",m+v);break;case"table_cell_height":c.parent().find("> th, > td").css("height","");c.css("height",m+v);break;case"table_row_height":c.find("> tbody > tr > td, > thead > tr > th").css("height","");c.find("> thead > tr > th:first-child, > tbody > tr > td:first-child").css("height",m+v);break;case"tve_margin_top":case"tve_margin_right":case"tve_margin_bottom":case"tve_margin_left":var w=b.parents(".tve_option_separator").first().find(".css-selector").val();if(w&&w.indexOf("_parent::")===0){c=c.parents(w.replace("_parent::","")).first()}else{if(w){c=c.find(w)}}c.css(b.attr("data-target"),m+"px");break;case"tve_padding_top":case"tve_padding_right":case"tve_padding_bottom":case"tve_padding_left":var w=b.parents(".tve_option_separator").first().find(".css-padding-selector").val();if(w&&w.indexOf("_parent::")===0){c=c.parents(w.replace("_parent::","")).first()}else{if(w){c=c.find(w)}}c.css(b.attr("data-target"),m+"px");break;case"tve_thrive_optin_text":c.tve_thrive_optin().text(m);break;case"ct_day":case"ct_hour":case"ct_min":case"ct_sec":case"ct_text":case"ct_expday":case"ct_exphour":if(c.hasClass("tve_countdown_timer_evergreen")){c.tve_countdown_timer_evergreen().set(b.attr("id").replace("ct_",""),m)}else{c.tve_countdown_timer().set(b.attr("id").replace("ct_",""),m)}break;case"posts_list_no_posts":case"posts_list_filter":case"posts_list_category":c.tve_thrive_posts_list().set(m,b.attr("id").replace("posts_list_",""));break;case"custom_phone_no":case"custom_phone_text":case"custom_mobile_phone_text":case"custom_phone_color":c.tve_thrive_custom_phone().set(m,b.attr("id").replace("custom_",""));break;case"custom_menu_menu":c.tve_thrive_custom_menus().set(m,b.attr("id").replace("custom_menu_",""));break;case"content_reveal_redirect_url":if(m.length){if(isValidUrl(m)){c.attr("data-redirect-url",m)}else{tve_add_notification("The redirection will not take place because the URL you've entered is not valid !",true,5000)}}break;case"responsive_video_type":case"responsive_video_url":var n=c.tve_responsive_video().set(m,b.attr("id").replace("responsive_video_",""));if(b.is("#responsive_video_type")){b.parents(".tve_menu").find(".responsive_video_option").css("display",m==="youtube"?"block":"none");jQuery("#responsive_video_url").val("");n.set("","url")}break;case"ct_max_width":var r=parseInt(m);if(isNaN(r)&&m!=="none"){tve_add_notification('Only digits are accepted or "none" string value !',true,4000);return}if(r<100){tve_add_notification("Max width cannot be smaller than 100 pixels !",true,4000);m="none"}c.css("max-width",m==="none"?m:r+"px");break;case"ct_min_width":var r=parseInt(m);if(isNaN(r)){tve_add_notification("Only digits are accepted !",true,4000);return}if(r<0){tve_add_notification("Min width cannot be lower than zero !",true,4000);return}c.css("min-width",r+"px");break;case"ct_columns":c.tve_contents_table().config("columns",b.val());break;case"qs_tw_via":c.tve_tw_qs().config("via",m);break;case"rating_value":case"rating_max":if(h=="rating_max"&&m>20){m=20;b.val(20)}c.tve_rating().set(b.attr("id").replace("rating_",""),m);break;case"lead_generation_button_text":if(m.length>=1){c.find("button").text(m)}break;case"img_alt_att":c.attr("alt",m);break;case"img_title_att":c.attr("title",m);break;case"tve_line_height":var g=b.parents(".tve_menu").first().find(".line-height-unit").text().toLowerCase()=="em"?"em":"px";c.css("line-height",m+g);break;case"lightbox_border_width":c.add(c.find(".tve_p_lb_close")).css("border-width",m+""+v);tve_path_params.tve_globals.l_cbw=m+""+v;break;case"lightbox_max_width":c.css("max-width",m+""+v);tve_path_params.tve_globals.l_cmw=m+""+v;break;case"lightbox_max_height":c.find("#tve-p-scroller").css("max-height",m+""+v);tve_path_params.tve_globals.l_cmh=m+""+v;break;case"table_outer_border":c.addClass("tve_no_border")&&o&&c.removeClass("tve_no_border");break;case"table_inner_border":c.addClass("tve_no_inner_border")&&o&&c.removeClass("tve_no_inner_border");break;case"tve_page_section_bg_fixed":c.tve_page_section().bgAttachment(o);break;case"tve_page_section_auto_height":c.tve_page_section().bgAutoHeight(o);break;case"tve_page_section_tmg":case"tve_page_section_bmg":var d=c.find("> .out"),l=b.attr("id").replace("tve_page_section_","");o?d.addClass(l):d.removeClass(l);break;case"posts_list_thumbnails":c.tve_thrive_posts_list().set(o?"on":"off","thumbnails");break;case"custom_menu_thumbnails":c.tve_thrive_custom_menus().set(o?"on":"off","thumbnails");break;case"rv_option_rel":c.tve_responsive_video().set(o?"0":"1","rel");break;case"rv_option_modestbranding":c.tve_responsive_video().set(o?"1":"0","modestbranding");break;case"rv_option_controls":c.tve_responsive_video().set(o?"0":"1","controls");break;case"rv_option_showinfo":c.tve_responsive_video().set(o?"0":"1","showinfo");break;case"rv_option_autoplay":c.tve_responsive_video().set(o?"1":"0","autoplay");break;case"rv_option_fs":c.tve_responsive_video().set(o?"0":"1","fs");break;case"ct_heading1":case"ct_heading2":case"ct_heading3":case"ct_heading4":case"ct_heading5":case"ct_heading6":var k=c.tve_contents_table();if(k.config("headers").length===3&&o===true){tve_add_notification("Only three headings can be selected at once !",true,3000);b.prop("checked",false)}else{k.updateHeaders(b.val())}break;case"lead_generation_form_target":c.tve_lead_generation().config("form-target",o?b.val():"");break;case"tve_landing_page_user_filter":tve_landing_pages_load({template:o?tve_path_params.landing_page:""});break;case"tve_lp_bg_fixed":c.tve_lp().bgAttachment(o);break;case"tve_lp_auto_height":c.tve_lp().bgCover(o);break;default:if(b.is("[type=checkbox]")&&b.hasClass("tve_landing_page_tag")){tve_landing_pages_filter()}else{if(b.hasClass("tve_css_applier")){if(!p){return}if(j=="icon"){c.parent().css(p,m+""+v);b.parents(".tve_menu").first().find("#border_radius_input").trigger("change")}else{c.css(p,m+""+v)}}else{tve_try_call_control(b,c,u,"change")}}break}}function isValidUrl(a){var b=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return b.test(a)}function tve_event_click(m,d,l,h){var k=d;d=get_element_from_wrapper(d,l);var b=m.attr("id");switch(b){case"tve_table_reset_cell_border":d.removeClass(border_styles).css("border-width","");break;case"tve_table_manage_cells":TVE_CellManager.init(d.is(".tve_table")?d:d.parents(".tve_table").first());break;case"tve_page_section_clear_shadow":d.tve_page_section().clearShadow();break;case"tve_page_section_clear_bg_color":d.tve_page_section().clearBgColor();break;case"tve_page_section_clear_bg_pattern":d.tve_page_section().clearBgPattern();break;case"tve_page_section_clear_bg_image":d.tve_page_section().clearBgImage();break;case"tve_page_section_s_light":case"tve_page_section_s_dark":d.find(".in").removeClass("lightSec darkSec").addClass(b.replace("tve_page_section_s_","")+"Sec");tve_set_selected_dropdown(m);return false;case"tve_page_section_bg_image":thrive_open_media(null,"load","page_section_background",d.tve_page_section().ensureCompliant());break;case"tve_page_section_p_default":case"tve_page_section_p_top":case"tve_page_section_p_bot":d.tve_page_section().position(b.replace("tve_page_section_p_",""));tve_set_selected_dropdown(m);return false;case"tve_margin_clear":var c=m.parents(".tve_option_separator").first().find(".css-selector").val(),j=d;if(c&&c.indexOf("_parent::")===0){j=d.parents(c.replace("_parent::","")).first()}else{if(c){j=d.find(c)}}j.css("margin","0px");if(l=="icon"){d.css("margin","0px")}load_button_values(k,l);break;case"tve_padding_clear":var c=m.parents(".tve_option_separator").first().find(".css-padding-selector").val(),j=d;if(c&&c.indexOf("_parent::")===0){j=d.parents(c.replace("_parent::","")).first()}else{if(c){j=d.find(c)}}j.css("padding","0px");load_button_values(d,l);break;case"tve_changeImageBtn":thrive_open_media(m,"load","icon_element",d);break;case"countdown_timer_align_left":case"countdown_timer_align_center":case"countdown_timer_align_right":case"countdown_timer_align_none":d.tve_countdown_timer().align(m.data("align"));break;case"tve_update_contents_table":d.tve_contents_table().update();break;case"add_tab":d.parent().tve_tabs().addTab();break;case"default_tab":d.parent().tve_tabs().setDefaultSelected(m.index());tve_set_selected_dropdown(m);break;case"tve_shortcode_edit":var g=d.find("> .tve_shortcode_raw").html();d.addClass("tve_active_lightbox");tve_show_tinymce_popup(g.replace("___TVE_SHORTCODE_RAW__","").replace("__TVE_SHORTCODE_RAW___",""));break;case"img_left_align":case"img_right_align":case"img_center_align":case"img_no_align":d.tve_image().align("align"+b.replace("img_","").replace("_align",""));break;case"tve_landing_page_disable":if(!confirm("Are you sure you want to revert this page back to the theme? You will lose the current page contents!")){return false}TVE_Content_Builder.controls.lb_close();tve_save_post(false,function(){tve_save_post_extra("landing_page",{tve_landing_page:""},function(){window.onbeforeunload=null;location.reload()})});break;case"tve_landing_page_select":var q=jQuery("#tve_landing_page_selector").find(".tve_landing_page_template.tve_cell_selected:visible input.lp_code");if(!q.length){tve_add_notification("First, you must select a template from the available ones.",true,5000);break}TVE_Content_Builder.controls.lb_close();tve_landing_page_select(q.val());break;case"tve_landing_page_reset":if(!confirm("Are you sure you want to CLEAR all content from this Landing Page? This action cannot be undone")){break}tve_landing_page_reset();break;case"tve_landing_page_save":var n=m.parent().find("input#tve_landing_page_name").val();if(!n){tve_add_notification("Please enter a template name, it will be easier to reload it after.",true,5000);break}tve_save_post(false,function(){jQuery("#tve_landing_page_msg").removeClass("tve_warning").addClass("tve_success").html("Page template successfully saved");tve_landing_pages_load({template:jQuery("#tve_landing_page_user_filter:checked").length?tve_path_params.landing_page:""})},{tve_landing_page_save:n});break;case"tve_landing_page_delete":var q=jQuery("#tve_landing_page_selector").find(".tve_landing_page_template.tve_cell_selected:visible input.lp_code");if(!q.length){tve_add_notification("Please select a saved template first",true,5000);break}if(!confirm("Are you sure you want to delete this saved template? This action cannot be undone")){break}tve_landing_page_delete(q.val());break;case"tve_clear_font_size":d.find(".tve_custom_font_size").each(function(){var r=jQuery(this),e=r.text();r.before(e);r.remove()});if(l==="button"){d.find("a.tve_btnLink").css("font-size","").css("line-height","");m.parents(".tve_menu").first().find(".tve_font_size").val(parseInt(d.find("a.tve_btnLink").css("font-size")));break}else{if(d.is("li")){d.parent().css("font-size","")}}d.css("font-size","");m.parents(".tve_menu").first().find(".tve_font_size").val(parseInt(d.css("font-size")));break;case"tve_clear_custom_font":if(l==="button"){d.find("a.tve_btnLink").removeClass(custom_font_classes).find(".tve_btn_txt, .tve_btn_text").removeClass(custom_font_classes);handle_custom_fonts(d.find("a.tve_btnLink"),m.parents(".tve_menu").first());break}d.removeClass(custom_font_classes);d.find("span.bold_text, span.italic_text, span.underline_text, span.strikethrough_text").removeClass(custom_font_classes);handle_custom_fonts(d,m.parents(".tve_menu").first());break;case"tve_clear_line_height":d.css("line-height","");load_button_values(d,l);break;case"text_bullet":tve_wrap_element_tags(d,"<ul class='thrv_wrapper'><li>","</li></ul>");break;case"text_numbered_bullet":tve_wrap_element_tags(jQuery(".edit_mode"),"<ol class='thrv_wrapper'><li class='edit_mode'>","</ol></ul>");convert_element_into_edit_mode(jQuery(".edit_mode"),h);break;case"tve_lightbox_bg_image":thrive_open_media(null,"load","lightbox_content_background",d);break;case"tve_lightbox_clear_bg_color":d.tve_lightbox().clearBgColor();break;case"tve_lightbox_clear_bg_pattern":d.tve_lightbox().clearBgPattern();break;case"tve_lightbox_clear_bg_image":d.tve_lightbox().clearBgImage();break;case"tve_lp_settings":hide_sub_menu();var f=jQuery(".tve_wrap_all");h.target=f;h.currentTarget=f;tve_editor_init(h,f);break;case"tve_lp_bg_image":thrive_open_media(null,"load","lp_background",d);break;case"tve_lp_clear_bg_color":d.tve_lp().clearBgColor();break;case"tve_lp_clear_bg_pattern":d.tve_lp().clearBgPattern();break;case"tve_lp_clear_bg_image":d.tve_lp().clearBgImage();break;default:if(m.hasClass("img_style")){d.tve_image().style(b);tve_set_selected_dropdown(m);break}else{if(m.hasClass("tve_landing_page_template")){m.parent().find(".tve_cell_selected").removeClass("tve_cell_selected");m.addClass("tve_cell_selected")}else{if(m.is(".tve_scT li")){var p=m.parents(".tve_scT").first(),a=p.find("> .tve_scTC").eq(m.index());if(m.attr("id")==="tve_saved_landing_pages"){tve_landing_pages_load()}p.find("> ul .tve_tS").removeClass("tve_tS");p.find("> .tve_scTC").hide();m.addClass("tve_tS");a.show()}else{if(m.hasClass("tve_font_selector")){if(l==="button"){var o=m.parents(".tve_menu").find("input.tve_font_size").val();d.find("a.tve_btnLink").removeClass(custom_font_classes).addClass(m.attr("data-cls")).css("font-size",o+"px").find(".tve_btn_txt, .tve_btn_text").removeClass(custom_font_classes).addClass(m.attr("data-cls"))}else{d.removeClass(custom_font_classes).addClass(m.attr("data-cls"));d.find("span.bold_text, span.italic_text, span.underline_text, span.strikethrough_text").removeClass(custom_font_classes).addClass(m.attr("data-cls"))}tve_set_selected_dropdown(m)}else{if(m.hasClass("tve_line_height_unit")){tve_set_selected_dropdown(m);m.parents(".tve_menu").first().find("#tve_line_height").trigger("change")}else{if(m.hasClass("tve_icon_align")){d.parent().removeClass("alignleft alignright aligncenter").addClass(m.attr("data-cls"))}else{return tve_try_call_control(m,d,h,"click")}}}}}}break}return true}function tve_event_mousedown(c,a,b,d){a=get_element_from_wrapper(a,b);switch(c.attr("id")){default:return tve_try_call_control(c,a,d,"mousedown")}}function tve_try_call_control(c,a,f,h){var d=c.attr("data-ctrl-"+h),b=c.attr("data-args-"+h);d=!d?c.attr("data-ctrl"):d;if(!d){return true}var g=tve_parse_ctrl_string(d,true);if(typeof g[1]!=="function"){return true}b=!b?c.attr("data-args"):b;b=!b?[]:b.split(",");b.push(c,a,f);return(g[1].apply(g[0],b)!==false)}function tve_after_apply_custom_color(b,a){if(b.hasClass("tve_table")){b.removeClass("tve_no_border tve_brdr_none");load_button_values(b.parents(".edit_mode").first(),"table")}}function tve_set_selected_dropdown(c,b){if(typeof b==="undefined"){b=false}var a=c.parents(".tve_option_separator").find("span").first();a.html(b?a.attr("data-default"):c.text())}function tve_show_tinymce_popup(a){TVE_Editor_Page.STATE="disabled";jQuery("body").addClass("mce_open");jQuery(".tve_mce_holder_overlay").show();jQuery("#tve_mce_holder").show();if(typeof tinymce!=="undefined"){if(!tinymce.activeEditor||tinymce.activeEditor.isHidden()){jQuery("#tve_tinymce_tpl").val(a)}else{tinymce.activeEditor.setContent(a)}}}function tve_hide_tinymce_popup(){TVE_Editor_Page.STATE="enabled";jQuery("body").removeClass("mce_open");jQuery(".tve_mce_holder_overlay").hide();jQuery("#tve_mce_holder").hide()}function tve_landing_page_select(a){tve_save_post(false,function(){tve_save_post_extra("landing_page",{tve_landing_page:a},function(){window.onbeforeunload=null;location.reload()})})}function tve_landing_page_reset(){TVE_Editor_Page.overlay();tve_save_post_extra("landing_page_reset",{},function(){window.onbeforeunload=null;location.reload()})}function tve_landing_page_save(a){TVE_Editor_Page.overlay();tve_save_post_extra("landing_page_save",{name:a},function(){TVE_Editor_Page.overlay("close")})}function tve_landing_pages_load(a){if(typeof a==="undefined"){a={}}a.action="tve_landing_pages_load";a.security=tve_path_params.tve_ajax_nonce;TVE_Editor_Page.overlay();jQuery.post(tve_path_params.ajax_url,a,function(b){jQuery("#tve_user_landing_pages").html(b);TVE_Editor_Page.overlay("close")})}function tve_landing_pages_filter(){var b="";jQuery(".tve_landing_page_filters:visible input.tve_change:checked").each(function(){b+=(b?",.":".")+this.value});var a=jQuery("#tve_default_landing_pages");if(!b){a.find(".tve_grid_cell").show();return}a.find(".tve_grid_cell").hide().filter(b).show()}function tve_landing_page_delete(a){tve_save_post_extra("landing_page_delete",{tve_landing_page:a},function(b){jQuery("#tve_user_landing_pages").html(b);TVE_Editor_Page.overlay("close")})}function tve_get_tinymce_content(){if(typeof tinymce==="undefined"){return""}if(!tinymce.activeEditor||tinymce.activeEditor.isHidden()){return jQuery("#tve_tinymce_tpl").val()}return tinymce.activeEditor.getContent()}function tve_parse_ctrl_string(b,f){if(!TVE_Content_Builder.global_func_cache){TVE_Content_Builder.global_func_cache={}}if(typeof TVE_Content_Builder.global_func_cache[b]!=="undefined"){return typeof f==="undefined"?TVE_Content_Builder.global_func_cache[b][1]:TVE_Content_Builder.global_func_cache[b]}b=b.replace("function:","");var d=b.split("."),c=d.shift(),e=TVE_Content_Builder,a=window;if(!d.length){e=window[c]}else{a=e;e=typeof e[c]!=="undefined"?e[c]:null;while(d.length&&e){c=d.shift();a=e;e=typeof e[c]!=="undefined"?e[c]:null}}if(e===null){return false}TVE_Content_Builder.global_func_cache[b]=[a,e];return typeof f==="undefined"?e:[a,e]}function tve_upgrade_element(c){var a=get_element_from_wrapper(jQuery(".edit_mode"),c);switch(c){case"button":if(!a.hasClass("tve_nb")){a.addClass("tve_nb");if(a.find("div.tve_left").length){var b=a.find("div.tve_left").html()+'<span class="tve_btn_divider"></span>',d=jQuery.trim(a.find("a").text());a.find("div.tve_left").replaceWith(jQuery('<span class="tve_left tve_btn_im"></span>').html(b));a.find("a").contents().filter(function(){return this.nodeType===3}).remove();a.find("a").append('<span class="tve_btn_txt">'+d+"</span>")}}break}}function tve_signum(a){return typeof a==="number"?(a?a<0?-1:1:a===a?0:NaN):NaN}var TVE_Editor_Page={STATE:"enabled",CPANEL_OPEN:false,SHIFT_KEY:false,editor:null,winWidth:null,htmlOffset:null,last_mce_id:"tve_reusable_tinymce",init:function(){this.editor=jQuery("#tve_editor");this.winWidth=jQuery(window).width();jQuery("body").addClass("wp-admin-bar");jQuery(".thrv_post_grid").tve_post_grid().masonry();activate_editmode_keyboard_listener();add_element_menu_icons();tve_refresh(true);this.bind();var a=jQuery(".thrv_countdown_timer");if(a.length){a.addClass("init_done").each(function(){if(jQuery(this).hasClass("tve_countdown_timer_evergreen")){jQuery(this).tve_countdown_timer_evergreen().update()}else{jQuery(this).tve_countdown_timer().update()}})}},disable:function(){this.STATE="disabled"},enable:function(){this.STATE="enabled";jQuery(this).trigger("editor.onenable")},bind:function(){var a=this;this.editor.on("click",editable_elements,function(b){b.preventDefault();a.STATE==="enabled"&&a.CPANEL_OPEN===false&&tve_editor_init(b,jQuery(this))});this.editor.on("mousedown",function(b){last_mouse_down=b.target});jQuery(this).bind("editor.oncolorpickerchange",jQuery.proxy(this.onColorpickerChange,this));jQuery(this).bind("editor.onundo",jQuery.proxy(this.onUndoAction,this));return this},onColorpickerChange:function(c,e,b){if(typeof e==="undefined"){return}var a=get_element_from_wrapper(jQuery(".edit_mode"),e);switch(e){case"page_section":var d=a.tve_page_section();if(b=="background-color"){d.clearBgImage().clearBgPattern()}d.transferShadow();break}},onUndoAction:function(){var a=jQuery(".edit_mode");if(!jQuery(".tve_cpanel_onpage:visible").length){a.removeClass("edit_mode")}else{load_button_values(a,get_shortcode_type_from_edit_mode(a))}TVE_Content_Builder.drag.refresh(true)},getPositionOffset:function(a){if(this.htmlOffset!==null){return this.htmlOffset}var d=a.parent(),b,e=0,c=false;while(!d.is("html")){b=d.css("position");if(b&&b!="static"){e+=d.offset().top;c=true;break}d=d.parent()}if(!c){e+=d.offset().top}this.htmlOffset=e;return e},overlay:function(b){var a="show";if(typeof b!=="undefined"){a="hide"}jQuery("#tve_page_loader")[a]()},thriveShrtcodeConfig:function(c,b){var a="__CONFIG_"+b+"__";return{update:function(f,e){var d=this.get();d[e]=f;this.save(d)},save:function(d){c.html(a+JSON.stringify(d)+a)},get:function(){var d=new RegExp(a,"g");return JSON.parse(c.html().replace(d,""))}}},minimizeMenu:function(){jQuery(".tve_cpanel_onpage").addClass("tve_m_minimized")},restoreMenu:function(){jQuery(".tve_cpanel_onpage").removeClass("tve_m_minimized")}};var TVE_CellManager={table:null,buttons:null,drag:{mouse_down:false,start_element:null,current_element:null,is_head:false},mouse_move_cells:"> thead > tr > th:not(.tve_merge_disabled), > tbody > tr > td:not(.tve_merge_disabled)",head_cells:"> thead > tr > th",body_cells:"> tbody > tr > td",head:null,body:null,grid:null,init:function(b){jQuery(".edit_mode").removeClass("edit_mode");if(typeof b!=="undefined"){this.table=b;tve_add_notification("Hold down the left mouse button on a cell and drag it across the highlighted table to select multiple cells!",false,5000)}this.head=this.table.find("> thead");this.body=this.table.find("> tbody");this.table.addClass("edit_mode tve_merge_cells").find("th, th *, td, td *").disableSelection();if(!this.buttons){this.buttons=jQuery("#tve_table_merge_actions")}hide_control_panel_menu();TVE_Editor_Page.disable();this.showActionButtons();this.bind();this.table.tve_rows(0);var c=new TVE_Table_Grid(this.head,true),a=new TVE_Table_Grid(this.body,true);if(isNaN(this.table.tve_cols())||isNaN(this.table.tve_rows())){this.table.tve_rows(c.getRowCount()+a.getRowCount());this.table.tve_cols(Math.max(c.getColCount(),a.getColCount()))}},showActionButtons:function(){var a=this.table.offset(),c=a.top,b=this;this.buttons.css({left:(a.left)+"px",width:this.table.outerWidth()}).find(".btn_table_action").unbind("click").click(jQuery.proxy(this.onActionClick,this));jQuery.when(this.buttons.show()).done(function(){b.buttons.css("top",(c-b.buttons.outerHeight()-TVE_Editor_Page.getPositionOffset(b.buttons))+"px")})},onActionClick:function(a){switch(a.currentTarget.id){case"tve_merge_cells_cancel":return this.cancel();case"tve_merge_cells_merge":return this.merge();case"tve_merge_cells_split":return this.split();case"tve_table_add_row":return this.addRow();case"tve_table_add_column":return this.addColumn();case"tve_table_remove_row":return this.removeRow();case"tve_table_remove_col":return this.removeColumn();case"tve_table_insert_col_after":return this.insertColumn("after");case"tve_table_insert_col_before":return this.insertColumn("before");case"tve_table_insert_row_after":return this.insertRow("after");case"tve_table_insert_row_before":return this.insertRow("before")}},bind:function(){this.table.off().on("mousedown",this.head_cells+", "+this.body_cells,jQuery.proxy(this.mouseDown,this));this.table.on("mousemove",this.mouse_move_cells,jQuery.proxy(this.mouseOver,this));this.table.on("mouseup",this.head_cells+", "+this.body_cells,jQuery.proxy(this.mouseUp,this));jQuery(TVE_Editor_Page).bind("editor.onenable",jQuery.proxy(this.cancel,this))},mouseDown:function(b){var a=jQuery(b.currentTarget);this.reset();this.drag.mouse_down=true;this.drag.start_element=a.addClass("tve_merge_selected");if(a.is("td")){this.table.find(this.head_cells).addClass("tve_merge_disabled");this.drag.is_head=false}else{this.table.find(this.body_cells).addClass("tve_merge_disabled");this.drag.is_head=true}this.grid=new TVE_Table_Grid(this.drag.is_head?this.head:this.body,false);this.grid.setStartCell(this.drag.start_element)},mouseUp:function(a){this.drag.mouse_down=false;if(!this.table.data("selected-cells")&&this.grid){this.table.data("selected-cells",this.grid.getRange(this.drag.start_element,jQuery(a.currentTarget)))}this.table.find(".tve_merge_disabled").removeClass("tve_merge_disabled")},mouseOver:function(b){if(!this.drag.mouse_down){return false}this.table.find("td,th").removeClass("tve_merge_selected");this.drag.current_element=jQuery(b.currentTarget);var a=this.grid.getRange(this.drag.start_element,this.drag.current_element);this.table.data("selected-cells",a);jQuery.each(a,function(){this.cell.addClass("tve_merge_selected")})},reset:function(){this.table.find(".tve_merge_selected").removeClass("tve_merge_selected");this.table.find(".tve_merge_disabled").removeClass("tve_merge_disabled");this.table.data("selected-cells",null).data("selected-colspan",null).data("selected-rowspan",null);this.drag={mouse_down:false,start_element:null,current_element:null,is_head:false}},cancel:function(){this.buttons.hide();this.reset();this.table.removeClass("edit_mode tve_merge_cells tve_table_light").off().find("th, th *, td, td *").enableSelection();jQuery(TVE_Editor_Page).unbind("editor.onenable");TVE_Editor_Page.enable();return this},merge:function(){if(!this.table.data("selected-cells")){return}var c=jQuery(),b="",a=jQuery();jQuery.each(this.table.data("selected-cells"),function(d){if(d==0){c=this.cell}else{a=a.add(this.cell);b+=this.cell.html()}});this.cancel();tve_set_window_content_before_action();c.append(b).attr({rowspan:this.grid.selection_rowspan,colspan:this.grid.selection_colspan});a.remove();tve_set_window_content_after_action();this.init()},split:function(){if(!this.table.data("selected-cells")){return}var b=this.table.data("selected-cells"),a=this.grid;this.cancel();tve_set_window_content_before_action();jQuery.each(b,function(){if(this.colspan==1&&this.rowspan==1){return true}a.split(this)});tve_set_window_content_after_action();this.init()},addRow:function(){var b=this.table.tve_rows(),c=this.table.tve_cols(),a;this.table.tve_rows(b+1);if(c===0){return}if(b===0){a=new TVE_Table_Grid(this.head)}else{a=new TVE_Table_Grid(this.body)}this.cancel();tve_set_window_content_before_action();a.insertRow(a.grid.length-1,"after",c);tve_set_window_content_after_action();this.init()},addColumn:function(){var a=this.table.tve_rows(),b=this.table.tve_cols();this.table.tve_cols(b+1);if(a===0){return}this.cancel();tve_set_window_content_before_action();if(this.table.find("> thead > tr").length){(new TVE_Table_Grid(this.head)).insertColumn(b-1,"after",this.table.find("> thead > tr").length)}if(this.table.find("> tbody > tr").length){(new TVE_Table_Grid(this.body)).insertColumn(b-1,"after",a-this.table.find("> thead > tr").length)}tve_set_window_content_after_action();this.init()},removeColumn:function(){if(!this.drag.start_element){return}var b=this.drag.start_element,c=this.drag.is_head;this.cancel();tve_set_window_content_before_action();var a=this.grid.selection_start.col,d=this.grid.removeColumn(b);if(c){(new TVE_Table_Grid(this.body)).removeColumn(null,a,d)}else{(new TVE_Table_Grid(this.head)).removeColumn(null,a,d)}this.table.tve_cols(this.table.tve_cols()-d);tve_set_window_content_after_action();this.init()},removeRow:function(){if(!this.drag.start_element){return}var b=this.drag.start_element,a=new TVE_Table_Grid(b.parent().parent());this.cancel();tve_set_window_content_before_action();var c=a.removeRow(b);this.table.tve_rows(this.table.tve_rows()-c);tve_set_window_content_after_action();this.init()},insertColumn:function(b){if(!this.drag.start_element){return}this.table.tve_cols(this.table.tve_cols()+1);if(this.table.tve_rows()==0){return}var a=this.grid[b=="before"?"selection_start":"selection_end"].col;this.cancel();tve_set_window_content_before_action();if(this.table.find("> thead > tr").length){(new TVE_Table_Grid(this.table.find("> thead"))).insertColumn(a,b,this.table.find("> thead > tr").length)}if(this.table.find("> tbody > tr").length){(new TVE_Table_Grid(this.table.find("> tbody"))).insertColumn(a,b,this.table.tve_rows()-this.table.find("> thead > tr").length)}tve_set_window_content_after_action();this.init()},insertRow:function(a){if(!this.drag.start_element){return}this.table.tve_rows(this.table.tve_rows()+1);if(this.table.tve_cols()==0){return}var b=this.grid[a=="before"?"selection_start":"selection_end"];this.cancel();tve_set_window_content_before_action();this.grid.insertRow(b.row,a,this.table.tve_cols(),b.col);tve_set_window_content_after_action();this.init()}};TVE_Table_Grid=function(b,a){var c=[],e=jQuery,f,d=0;b.find("> tr").each(function(g){e(this).find("> td, > th").each(function(k){var h,o,l,n,m=e(this);if(c[g]){while(c[g][k]){k++}}l=m.tve_rowspan();n=m.tve_colspan();for(o=g;o<g+l;o++){if(!c[o]){c[o]=[]}for(h=k;h<k+n;h++){c[o][h]={cell:m,rowspan:l,colspan:n,exists:o==g&&h==k,processed:false,real_row:g,real_col:k}}}})});this.grid=c;this.startPos=null;this.selection_colspan=1;this.selection_rowspan=1;this.container=b;this.is_head=b.is("thead");this.selection_start={row:null,col:null};this.selection_end={row:null,col:null};if(typeof a!=="undefined"&&a){b.parent().tve_rows(parseInt(b.parent().tve_rows())+this.grid.length);if(this.grid[0]&&this.grid[0].length){b.parent().tve_cols(this.grid[0].length)}}};TVE_Table_Grid.prototype.getRange=function(m,b){var a=this.startPos,c=this.getCellPosition(b);if(!a||!c){return jQuery()}var k=Math.min(a.x,c.x),l=Math.max(a.x,c.x),n=Math.min(a.y,c.y),p=Math.max(a.y,c.y),h=p,e=l,f=0,d,o,r=false;for(var f=0,q;q=this.grid[f++];){for(var d=0,o;o=q[d++];){o.processed=false}}do{r=false;f=k;while(f<=e){o=this.grid[f][n];f+=o.rowspan;if(o.processed||o.exists){continue}if(o.colspan>1){n=o.real_col;r=true;o.processed=true}}d=n;while(d<=h){o=this.grid[k][d];d+=o.colspan;if(o.processed||o.exists){continue}if(o.rowspan>1){k=o.real_row;r=true;o.processed=true}}for(f=k;f<=e;f++){for(d=n;d<=h;d++){o=this.grid[f][d];if(!o.exists||o.processed){continue}if(o.colspan>1&&o.colspan-1+d>h){h=d+o.colspan-1;r=true;o.processed=true}if(o.rowspan>1&&o.rowspan-1+f>e){e=f+o.rowspan-1;r=true;o.processed=true}}}}while(r);var g=[];for(f=k;f<=e;f++){for(d=n;d<=h;d++){if(this.grid[f][d]&&this.grid[f][d].exists){g.push(this.grid[f][d])}}}this.selection_rowspan=e-k+1;this.selection_colspan=h-n+1;this.selection_start.row=k;this.selection_start.col=n;this.selection_end.row=e;this.selection_end.col=h;return g};TVE_Table_Grid.prototype.getCellPosition=function(a){for(var d=0,e=this.grid.length;d<e;d++){for(var c=0,b=this.grid[d].length;c<b;c++){if(this.grid[d][c]["cell"][0]===a[0]){return{x:d,y:c}}}}return null};TVE_Table_Grid.prototype.setStartCell=function(a){this.startPos=this.getCellPosition(a)};TVE_Table_Grid.prototype.split=function(d){d.cell.attr("colspan",1).attr("rowspan",1);for(var b=1;b<d.colspan;b++){d.cell.after(d.cell.clone().html(""))}if(d.rowspan==1){return}var e=d.cell.parent();for(var f=d.real_row+1;f<d.real_row+d.rowspan;f++){e=e.next("tr");if(e.find("> td, > th").length==0){for(var g=0;g<d.colspan;g++){e.append(d.cell.clone().html("<p>Cell content</p>"))}continue}for(var a=d.real_col-1;a>=0;a--){if(this.grid[f][a].real_row==f){for(var g=0;g<d.colspan;g++){this.grid[f][a].cell.after(d.cell.clone().html("<p>Cell content</p>"))}break}}if(d.real_col==0||a==-1){for(var g=0;g<d.colspan;g++){e.prepend(d.cell.clone().html("<p>Cell content</p>"))}}}};TVE_Table_Grid.prototype.removeColumn=function(f,b,d){if(f){d=f.tve_colspan();b=(this.getCellPosition(f)).y}for(var c=0,g;g=this.grid[c++];){for(var a=b;a<b+d;a++){var e=g[a];if(e.colspan==1||(f&&e.cell[0]===f[0])){e.cell.remove();continue}if(e.real_col>=b&&e.real_col+e.colspan<=b+d){e.cell.remove();continue}if(e.colspan>1){if(e.real_col<=b){if(e.real_col+e.colspan>=b+d){e.cell.attr("colspan",e.colspan-d)}else{e.cell.attr("colspan",Math.abs(b-e.real_col))}}else{e.cell.attr("colspan",e.real_col+e.colspan-b-d)}}else{e.cell.remove()}}}return d};TVE_Table_Grid.prototype.removeRow=function(k){var b=k.tve_rowspan(),l=this.getCellPosition(k),f=jQuery();for(var e=l.x;e<=l.x+b-1;e++){for(var d=0;d<this.grid[l.x].length;d++){var m=this.grid[e][d];if(d==l.y||m.cell.tve_rowspan()==1){f=f.add(this.container.find("> tr:nth-child("+(e+1)+")"));continue}if(!m.exists){m.cell.attr("rowspan",m.cell.tve_rowspan()-1);d+=m.cell.tve_colspan()-1}else{if(m.cell.tve_rowspan()+e<=l.x+b){}else{var c=l.x+b-e;var h=m.cell.clone().attr("rowspan",m.cell.tve_rowspan()-c);m.cell.attr("rowspan",c);var g=k.parent().next(),n=l.x+b;if(g.length>0){if(g.find("> td, > th").length==0){g.append(h)}for(var a=m.real_col-1;a>=0;a--){if(this.grid[n][a].real_row==n){this.grid[n][a].cell.after(h);break}}if(m.real_col==0||a==-1){g.prepend(h)}}}}}}f.remove();return b};TVE_Table_Grid.prototype.insertColumn=function(e,c,l){var f=this.is_head?'<th class="tve_table_cell"><p>Cell content</p></th>':'<td class="tve_table_cell"><p>Cell content</p></td>',a=this.grid[0]&&this.grid[0].length,j=jQuery();for(var b=0;b<l;b++){var m=(a?this.grid[b][e]:null),d;if(!m){d=this.container.find("> tr:nth-child("+(b+1)+")");d=d.length?d:jQuery('<tr class="tve_table_row"></tr>').appendTo(this.container);j=j.add(jQuery(f));d.append(j.last());continue}var g=m.cell.clone().attr("colspan","1").attr("rowspan","1").html("<p>Cell content</p>"),d=this.getRealRow(b),k=false;if(e==this.grid[0].length-1&&c=="after"){d.append(g);j=j.add(g);continue}if(e==0&&c=="before"){d.prepend(g);j=j.add(g);continue}if(m.colspan>1){if(c=="after"&&m.real_col+m.colspan-1>e){m.cell.attr("colspan",m.colspan+1);k=true}else{if(c=="before"&&m.real_col<e){m.cell.attr("colspan",m.colspan+1);k=true}}}if(!k){m=c=="after"?this.getLastRealCell(b,e):this.getNextRealCell(b,e);var h=c;if(m===null){m=c=="after"?this.getNextRealCell(b,e):this.getLastRealCell(b,e);h=c=="after"?"before":"after"}if(m===null){d.append(g);j=j.add(g);continue}m.cell[h](g);j=j.add(g)}else{b+=m.rowspan-1}}TVE_Content_Builder.drag.bind_draggable(j);TVE_Content_Builder.drag.ensure_dropzones(j)};TVE_Table_Grid.prototype.insertRow=function(b,f,k){var h=this.is_head?'<th class="tve_table_cell"><p>Cell content</p></th>':'<td class="tve_table_cell"><p>Cell content</p></td>',d=jQuery('<tr class="tve_table_row"></tr>');if(b===-1){for(var e=0;e<k;e++){d.append(jQuery(h))}this.container.append(d);return}var g=this.getRealRow(b),a=jQuery();for(var c=0;c<k;c++){var m=this.grid[b][c],l=false;if(m.rowspan>1){if(f=="after"&&m.real_row+m.rowspan-1>b){m.cell.attr("rowspan",m.rowspan+1);l=true}else{if(f=="before"&&m.real_row<b){m.cell.attr("rowspan",m.rowspan+1);l=true}}}if(!l){a=a.add(this.grid[b][c].cell.clone().html("<p>Cell content</p>").attr({rowspan:1,colspan:1}))}}g[f](d.append(a));TVE_Content_Builder.drag.bind_draggable(d);TVE_Content_Builder.drag.ensure_dropzones(d)};TVE_Table_Grid.prototype.getRealRow=function(c){if(!this.grid[c]){return jQuery()}for(var a=0,b;b=this.grid[c][a++];){if(b.real_row==c){return b.cell.parent()}}return this.container.find("tr:nth-child("+(++c)+")")};TVE_Table_Grid.prototype.getLastRealCell=function(c,b){if(!this.grid[c]){return null}for(var a=b;a>=0;a--){if(this.grid[c][a].real_row==c&&this.grid[c][a].real_col==a){return this.grid[c][a]}}return null};TVE_Table_Grid.prototype.getNextRealCell=function(d,c){if(!this.grid[d]){return null}for(var b=c,a=this.grid[d].length;b<a;b++){if(this.grid[d][b].real_row==d&&this.grid[d][b].real_col==b){return this.grid[d][b]}}return null};TVE_Table_Grid.prototype.getRowCount=function(){return this.grid.length};TVE_Table_Grid.prototype.getColCount=function(){if(!this.grid[0]){return 0}return this.grid[0].length};jQuery.fn.extend({tve_rowspan:function(){return(this.attr("rowspan")?parseInt(this.attr("rowspan")):1)},tve_colspan:function(){return(this.attr("colspan")?parseInt(this.attr("colspan")):1)},tve_rows:function(){if(arguments.length===0){return parseInt(this.attr("data-rows"))}return this.attr("data-rows",arguments[0])},tve_cols:function(){if(arguments.length===0){return parseInt(this.attr("data-cols"))}return this.attr("data-cols",arguments[0])},tve_color_selector:function(){return this.attr("data-tve-custom-colour")},tve_page_section:function(){var a=this,b=this.find("> .out"),c=b.find("> .in");return{ensureCompliant:function(){if(!c.find("> .cck").length){c.children().wrapAll('<div class="cck clearfix"></div>')}return a},setBgPattern:function(d){this.clearBgImage().clearBgColor();b.css({"background-image":"url('"+d+"')","background-repeat":"repeat"})},setBgImage:function(d){this.clearBgImage();c.addClass("pddbg").css({"box-sizing":"border-box","background-image":"url('"+d.url+"')","background-repeat":"","max-width":TVE_Editor_Page.winWidth+"px"});b.addClass("pswr");this.transferShadow();c.attr({"data-width":d.width,"data-height":d.height})},clearBgImage:function(){c.removeClass("pddbg").css({"background-image":"","background-repeat":"","max-width":"","-moz-box-shadow":"","-webkit-box-shadow":"","box-shadow":"","box-sizing":""});b.removeClass("pswr");return this},clearShadow:function(){tve_remove_css_rule(b.tve_color_selector(),"box-shadow -moz-box-shadow -webkit-box-shadow");b.add(c).css({"-moz-box-shadow":"","-webkit-box-shadow":"","box-shadow":""});return this},clearBgPattern:function(){b.removeClass("pattern1 pattern2 pattern3");b.css({"background-image":"","background-repeat":""});return this},clearBgColor:function(){if(b.tve_color_selector()){tve_remove_css_rule(b.tve_color_selector(),"background-color")}b.css("background-color","");return this},transferShadow:function(){var d=a.find(".out.pswr > .in");if(d.length){d.css({"-moz-box-shadow":b.css("-moz-box-shadow"),"-webkit-box-shadow":b.css("-webkit-box-shadow"),"box-shadow":b.css("box-shadow")})}else{c.css({"-moz-box-shadow":"","-webkit-box-shadow":"","box-shadow":""})}},bgAttachment:function(e){c.removeClass("pdwbg");if(e){var d=a.find(".out.pswr > .in");if(d.length){c.addClass("pdwbg")}}},bgAutoHeight:function(g){c.removeClass("pdfbg").css({"box-sizing":"",height:"",width:""});if(g){var f=parseInt(c.attr("data-width")),e=parseInt(c.attr("data-height")),d=c.width(),h="";if(isNaN(f)||isNaN(e)){return}if(d<f){var j=f/e;h=parseInt(d/j)}else{h=e}c.addClass("pdfbg").css({"box-sizing":"border-box",height:h+"px"})}},position:function(d){d=d==="bot"?"bottom":d;b.removeClass("top bot bottom");if(d!="default"){b.addClass(d)}}}},tve_thrive_optin:function(){var a=this,b=TVE_Editor_Page.thriveShrtcodeConfig(a.find(".thrive-shortcode-config"),"optin"),e=a.find("> .thrive-shortcode-html > .scon"),c=a.find("input[type=text]").length,d=a.find(".btn");return{fetch:function(f){var g=b.get();g.optin=f;g.nowrap=1;TVE_Editor_Page.overlay();jQuery.post(tve_path_params.shortcodes_dir+"sc_thrive_optin.php",g,function(h){a.html(h);TVE_Editor_Page.overlay("close")})},color:function(f){jQuery.each(tve_path_params.thrive_optin_colors,function(g){d.removeClass(g)});d.addClass(f);b.update(f,"color")},size:function(f){d.removeClass("small medium big").addClass(f);b.update(f,"size")},layout:function(f){e.removeClass("wide otit");if(f=="horizontal"){e.addClass("wide");if(c>=3){e.addClass("otit")}}b.update(f,"layout")},text:function(f){d.find("input").val(f);b.update(f,"text")},config:function(){return b.get()}}},tve_countdown_timer:function(){var a=this,b=function(c,e){c.empty();if(e<=99){c.prepend('<span class="part-1">'+e%10+"</span>");c.prepend('<span class="part-2">'+Math.floor(e/10)+"</span>")}else{var d=0;while(e){d++;c.prepend('<span class="part-'+d+'">'+(e%10)+"</span>");e=Math.floor(e/10)}}};return{set:function(d,c){a.attr("data-"+d,c);this.update()},get:function(c){if(c=="_all"){return this.get("date")+"T"+this.get("hour")+":"+this.get("min")+":00"+this.get("timezone")}return a.attr("data-"+c)},update:function(){var e=new Date(),j=new Date(this.get("_all"));a.find(".tve_t_text").hide().html(this.get("text"));a.find(".tve_t_part").show();var h=0,g=0,c=0,d=0,f;if(e<j){h=Math.floor((j.getTime()-e.getTime())/1000);g=Math.floor(h/60);c=Math.floor(g/60);d=Math.floor(c/24);f=2;h=h%60;g=g%60;c=c%24;if(d>99){f=d.toString().length}a.find(".tve_t_day .t-digits").css("min-width",(f*25)+"px")}b(a.find(".tve_t_sec .t-digits"),h);b(a.find(".tve_t_min .t-digits"),g);b(a.find(".tve_t_hour .t-digits"),c);b(a.find(".tve_t_day .t-digits"),d)},align:function(d){var c=a.children(".sc_timer_content");c.css("margin-top",c.css("margin-top"));c.css("margin-bottom",c.css("margin-bottom"));switch(d){case"left":c.removeClass("alignleft alignright aligncenter").addClass("alignleft");break;case"center":c.removeClass("alignleft alignright").addClass("tve_block_center");break;case"right":c.removeClass("alignleft alignright aligncenter").addClass("alignright");break;case"none":c.removeClass("alignleft alignright aligncenter").css("width","auto");break}}}},tve_countdown_timer_evergreen:function(){var a=jQuery(this),b=a.tve_countdown_timer();setValues=function(c,e){c.empty();if(e<=99){c.prepend('<span class="part-1">'+e%10+"</span>");c.prepend('<span class="part-2">'+Math.floor(e/10)+"</span>")}else{var d=0;while(e){d++;c.prepend('<span class="part-'+d+'">'+(e%10)+"</span>");e=Math.floor(e/10)}}};b.update=function(){var e=new Date(),j=new Date();j.setTime(e.getTime()+(parseInt(this.get("day"))*24*3600*1000)+(parseInt(this.get("hour"))*3600*1000)+(parseInt(this.get("min"))*60*1000)+(parseInt(this.get("sec"))*1000));a.find(".tve_t_text").hide().html(this.get("text"));a.find(".tve_t_part").show();a.attr("data-id",_.uniqueId("evergreen_"));var h=0,g=0,c=0,d=0,f;if(e<j){h=Math.floor((j.getTime()-e.getTime())/1000);g=Math.floor(h/60);c=Math.floor(g/60);d=Math.floor(c/24);f=2;h=h%60;g=g%60;c=c%24;if(d>99){f=d.toString().length}a.find(".tve_t_day .t-digits").css("min-width",(f*25)+"px")}setValues(a.find(".tve_t_sec .t-digits"),h);setValues(a.find(".tve_t_min .t-digits"),g);setValues(a.find(".tve_t_hour .t-digits"),c);setValues(a.find(".tve_t_day .t-digits"),d);return this};return b},tve_thrive_posts_list:function(){var a=this,b=TVE_Editor_Page.thriveShrtcodeConfig(a.find(".thrive-shortcode-config"),"posts_list");return{fetch:function(){var c=b.get();c.nowrap=1;TVE_Editor_Page.overlay();jQuery.post(tve_path_params.shortcodes_dir+"sc_thrive_posts_list.php",c,function(d){a.html(d);TVE_Editor_Page.overlay("close")})},set:function(c,d){b.update(c,d);this.fetch()},config:function(){return b.get()}}},tve_thrive_custom_phone:function(){var a=this,b=TVE_Editor_Page.thriveShrtcodeConfig(a.find(".thrive-shortcode-config"),"custom_phone");return{fetch:function(){var c=b.get();c.nowrap=1;TVE_Editor_Page.overlay();jQuery.post(tve_path_params.shortcodes_dir+"sc_thrive_custom_phone.php",c,function(d){a.html(d);TVE_Editor_Page.overlay("close")})},set:function(c,d){b.update(c,d);this.fetch()},config:function(){return b.get()}}},tve_thrive_custom_menus:function(){var a=this,b=TVE_Editor_Page.thriveShrtcodeConfig(a.find(".thrive-shortcode-config"),"custom_menu");return{fetch:function(){var c=b.get();c.nowrap=1;TVE_Editor_Page.overlay();jQuery.post(tve_path_params.shortcodes_dir+"sc_thrive_custom_menu.php",c,function(d){a.html(d);TVE_Editor_Page.overlay("close")})},set:function(c,d){b.update(c,d);this.fetch()},config:function(){return b.get()}}},tve_tw_qs:function(){var a=this;return{config:function(c,b){if(typeof c==="undefined"|c.length===0){throw"Invalid option"}if(typeof b==="undefined"){return this.get(c)}return this.set(c,b)},set:function(c,b){a.attr("data-"+c,b);return this},get:function(b){return a.attr("data-"+b)}}},tve_contents_table:function(){var a=this;var b={options:new Array(),$container:null,init:function(){this.config("columns",a.attr("data-columns"));this.initHeaders();this.$container=a.find(".tve_contents_table");return this},set:function(d,c){this.options[d]=c;this.saveConfig(d,c);return this},get:function(c){return this.options[c]},saveConfig:function(d,c){a.attr("data-"+d,c)},updateHeaders:function(d){for(var c=0;c<this.options.headers.length;c++){if(this.options.headers[c]===d){this.options.headers.splice(c,1);this.config("headers",this.options.headers.sort());return this}}this.options.headers.push(d);this.config("headers",this.options.headers.sort());return this},initHeaders:function(){if(typeof a.data("headers")==="undefined"){this.config("headers",new Array("h1","h2","h3"))}else{if(a.attr("data-headers").length===0){this.config("headers",new Array())}else{this.config("headers",a.attr("data-headers").split(","))}}return this},config:function(d,c){if(typeof d==="undefined"|d.length===0){throw"Invalid option"}if(typeof c==="undefined"){return this.get(d)}return this.set(d,c)},update:function(){var c=this;this.$container.find("a").remove();if(!this.options.headers.length){return}jQuery("#tve_editor, #tve_editor .tve_editor_main_content").find(this.config("headers").join(",")).each(function(){var f=jQuery(this),e=f.text().sanitize_for_hash(),d=jQuery('<a class="'+c.getCssClass(f)+'" href="#'+e+'">'+f.text()+"</a>");a.find(".tve_ct_content").append(d);f.attr("id",e)});a.find(".tve_ct_title").text(this.config("title"));this.splitInColumns()},getCssClass:function(c){return"tve_ct_level"+this.config("headers").indexOf(c[0].nodeName.toLowerCase())},splitInColumns:function(){a.find(".tve_ct_content").children(".leftCol, .rightCol").remove();var c=a.find(".tve_ct_content .tve_ct_level0").length,j=0,f=new Array(),d=this;for(var e=0;e<this.config("columns");e++){var h=jQuery('<div class="ct_column sep"></div>');f.push(h)}f.push(f.pop().removeClass("sep"));a.find(".tve_ct_content .ct_column").remove();if(c<=1){return}var g=0;a.find(".tve_ct_content").children(".tve_ct_level0, .tve_ct_level1, .tve_ct_level2").each(function(l){var m=jQuery(this);if(m.is(".tve_ct_level0")){g=Math.floor(j*f.length/c)}f[g].append(function(){return m});if(m.is(".tve_ct_level0")){j++}});a.find(".tve_ct_content").html("");for(var e=0,h;h=f[e++];){h.css("width",100/f.length+"%");a.find(".tve_ct_content").append(h)}var k=0;a.find(".ct_column").each(function(){var l=jQuery(this);if(l.height()>k){k=l.height()}});a.find(".ct_column").css("min-height",k+"px")}};return b.init()},tve_responsive_video:function(){var a=this;return{fetch:function(){if(this.config("url")){a.find("iframe").attr("src",this.config("embeded-url")+(this.config("type")==="youtube"?this.queryString():""));a.find(".tve_responsive_video_container").css("display","block");a.find(".tve_green_button").remove();a.removeClass("responsive_video_placeholder")}return this},set:function(b,c){if(c==="url"){a.attr("data-url",b);a.attr("data-embeded-url",this.embededUrl(b));return this.fetch()}a.attr("data-"+c,b);this.fetch()},embededUrl:function(d){var b="";switch(this.config("type")){case"youtube":if(d.indexOf("embed")!==-1){return d}b="//www.youtube.com/embed/";var c=d.split("?").pop().split("&").shift().split("=")[1];b+=c;break;case"vimeo":b="//player.vimeo.com/video/"+d.split("/").pop();break}return b},queryString:function(){var c="?";var b=new Array("rel="+(typeof this.config("rel")==="undefined"?"1":this.config("rel")),"modestbranding="+(typeof this.config("modestbranding")==="undefined"?"0":this.config("modestbranding")),"controls="+(typeof this.config("controls")==="undefined"?"1":this.config("controls")),"showinfo="+(typeof this.config("showinfo")==="undefined"?"1":this.config("showinfo")),"autoplay="+(typeof this.config("autoplay")==="undefined"?"0":this.config("autoplay")),"fs="+(typeof this.config("fs")==="undefined"?"1":this.config("fs")));c+=b.join("&");c+="&wmode=transparent";return c},config:function(b){return a.attr("data-"+b)}}},tve_tabs:function(){var a=this,c=a.find("> .tve_scT"),b=function(d){return c.find("> .tve_scTC").eq(d.index())};return{isVertical:function(){return c.hasClass("tve_vtabs")},show:function(d){c.find("> ul li").removeClass("tve_tS").eq(d).addClass("tve_tS");c.find("> .tve_scTC").hide().eq(d).show()},addTab:function(){var g=c.find("> ul li").length+1,h=c.find("> ul li:not(.tve_tS)").first().attr("data-tve-custom-colour"),e='<li data-tve-custom-colour="'+h+'"><span>New Tab</span></li>',d=c.find("> div").first().attr("data-tve-custom-colour"),f=jQuery('<div class="tve_scTC" style="display: none;" data-tve-custom-colour="'+d+'"><p>Tab '+g+"</p></div>");c.find("> ul").append(e);c.append(f);TVE_Content_Builder.drag.ensure_dropzones(f.find("p"));TVE_Content_Builder.drag.bind_draggable(f);if(this.isVertical()){this.resize()}},removeTab:function(d){b(d).remove();d.remove();if(a.find("li").length===0){return}this.setDefaultSelected();if(this.isVertical()){this.resize()}this.populateTabList();var e=parseInt(this.getDefaultSelected());if(e>=c.find("> ul li").length){this.setDefaultSelected(e-1)}},resize:function(){c.find(".tve_scTC").css("min-height",(c.find("> ul").outerHeight()+40)+"px")},populateTabList:function(){var d=jQuery("ul#tve_tabs_selected").empty();c.find("> ul li").each(function(){d.append(jQuery('<li class="tve_btn_text tve_click tve_selected_tab" id="default_tab">'+jQuery(this).text()+"</li>"))});return this},getDefaultSelected:function(){var d=c.attr("data-selected");if(!d){d=0;this.setDefaultSelected(0)}return d},setDefaultSelected:function(d){if(typeof d==="undefined"){d=this.getDefaultSelected()}c.attr("data-selected",d);this.show(d)}}},tve_rating:function(){var b=this,a=b.children(".tve_rating_stars").first(),d=a.children("span").first(),c=24;return{set:function(f,e){a.attr("data-"+f,e);this.draw()},get:function(e){return a.attr("data-"+e)},draw:function(){var f=parseFloat(this.get("value")),e=parseInt(this.get("max"));if(isNaN(f)){f=0}if(isNaN(e)){e=5}if(f>e){f=e;this.set("value",f)}a.css("width",e*c+"px");d.css("width",f*c+"px");a.attr("title",f+" / "+e)}}},tve_lead_generation:function(){var a=this;var b={$formContainer:a.find(".thrv_lead_generation_container"),jsonFields:null,code:a.find(".thrv_lead_generation_code").html(),init:function(){this.binds();jQuery('textarea[name="tve_lead_generation_code"]').val(jQuery(".edit_mode").find(".thrv_lead_generation_code").text());return this},binds:function(){var c=this;jQuery(".tve_lead_generate_fields").click(function(){TVE_Editor_Page.overlay();var e=jQuery(this);var d={autoresponder_code:jQuery('textarea[name="tve_lead_generation_code"]').val(),nonce:tve_path_params.tve_ajax_nonce,id_post:tve_path_params.post_id,action:"tve_optin_render_fields",dataType:"json"};this.code=d.autoresponder_code;jQuery(".edit_mode").find(".thrv_lead_generation_code").text(d.autoresponder_code);jQuery.post(tve_path_params.ajax_url,d,function(f){c.jsonFields=JSON.parse(f);jQuery("#generated_inputs_container").html(c.jsonFields.html);c.bindSaveFields();TVE_Editor_Page.overlay("close")})});return this},bindSaveFields:function(){var c=this;jQuery("#thrive_btn_save_autoresponder_fields").click(function(){var d=jQuery(".edit_mode").tve_lead_generation();d.jsonFields=c.jsonFields;d.requestData=c.requestData;d.generateForm();TVE_Content_Builder.controls.lb_close()});return this},config:function(d,c){if(typeof d==="undefined"|d.length===0){throw"Invalid option"}if(typeof c==="undefined"){return this.get(d)}return this.set(d,c)},set:function(d,c){a.attr("data-"+d,c);return this},get:function(c){return a.attr("data-"+c)},generateForm:function(){var e=jQuery('<form method="'+this.jsonFields.fields.form_method+'" action="'+this.jsonFields.fields.form_action+'"></form>'),g=jQuery('<div class="tve_lead_generated_inputs_container tve_clearfix"><div class="tve_lead_fields_overlay"></div></div>'),j=jQuery("#lead_generation_button_text").val();e.append(this.jsonFields.fields.hidden_inputs);if(this.jsonFields.fields.text_inputs.length){for(var h=0,d;d=this.jsonFields.fields.text_inputs[h++];){var f=d.replace(/_tbl_/g,"[").replace(/_tbr_/g,"]").replace(/_tbl2_/g,"(").replace(/_tbr2_/g,")").replace(/_tsp_/g," ");var c=jQuery("#txt_label_"+d.split(" ").join("_")).val();g.append('<div class="tve_lg_input_container"><input type="text" name="'+f+'" placeholder="'+c+'" data-placeholder="'+c+'" /></div>')}}g.append('<div class="tve_lg_input_container tve_submit_container"><button type="submit">'+(j?j:"Submit")+"</button></div>");e.append(g);if(this.$formContainer.find(".thrv_icon").length){g.find(".tve_submit_container").prepend(this.$formContainer.find(".thrv_icon"))}this.$formContainer.html("").append(e);this.applyStyle("thrv_lead_generation_vertical")},applyStyle:function(d){var c=a.find('input[type="text"]').length;a.removeClass("thrv_lead_generation_vertical thrv_lead_generation_horizontal").addClass(d);if(c===1||c===3){a.find(".tve_lg_input_container").addClass("tve_lg_2")}else{if(c>=2){a.find(".tve_lg_input_container").addClass("tve_lg_3")}}tve_set_selected_dropdown(jQuery("#"+d))}};return b.init()},tve_image:function(){var a={e:null,i:null,init:function(b){this.e=b;this.i=b;if(this.i.parents(".thrv_feature_grid .tve_gri").length){return this}return this.ensureCompliant()},ensureCompliant:function(){var e=this.e,d=["alignleft","aligncenter","alignright"],f=["margin","margin-top","margin-left","margin-right","margin-bottom"];if(e.parent().is("a")){e=e.parent()}if(!e.parent().is(".tve_image_frame")){e.wrapAll('<span class="tve_image_frame"></span>')}e=e.parent();if(!e.parent().is(".tve_image_caption")){e.wrapAll('<div class="tve_image_caption thrv_wrapper"></div>')}e.parent().css("width",this.e.outerWidth(true)+"px");this.e=e.parent();for(var c=0,b;b=d[c++];){if(this.i.hasClass(b)){this.i.removeClass(b);this.e.addClass(b)}}for(c=0;b=f[c++];){if(this.i.css(b)&&this.i.css(b)!="0px"){this.e.css(b,this.i.css(b));this.i.css(b,"")}}this.checkCaption();return this},hasStyle:function(d){if(d!=="__none__"){return this.e.hasClass(d)}var b=this,c=false;jQuery.each(img_styles.split(" "),function(f,e){if(b.e.hasClass(e)){c=true}});return !c},align:function(b){this.e.removeClass("alignleft aligncenter alignright").addClass(b.replace("alignno",""));if(b=="aligncenter"){this.e.css({"margin-left":"","margin-right":""})}},style:function(b){this.e.removeClass(img_styles).addClass(b);this.checkCaption()},attach:function(b){if(b.alt){this.i.attr("alt",b.alt)}if(!b.caption){this.e.find(".wp-caption-text").remove()}else{if(this.e.find(".wp-caption-text").length===0){this.e.append('<p class="wp-caption-text"></p>')}this.e.find(".wp-caption-text").html(b.caption)}this.i.css("width",b.width+"px");this.e.css("width",b.width+"px");this.i.attr("src",b.url).removeClass("tve_active_image");this.checkCaption()},checkCaption:function(){if(!this.hasCaption()||!this.hasStyle("__none__")){this.e.removeClass("wp-caption")}else{this.e.addClass("wp-caption")}},hasCaption:function(){return this.e.find(".wp-caption-text").length&&this.e.find(".wp-caption-text").text().length}};return a.init(this)},tve_widgets:function(c){var d=jQuery.extend({wrapper:null,optionsContianer:jQuery("#options_container")},c);var b=TVE_Editor_Page.thriveShrtcodeConfig(d.wrapper.find(".tve_config"),"widget");var f={config:b,wrapper:this,displayWidget:function(){if(!this.config.get().widget.length){jQuery(".tve_widget_container",d.wrapper).html("");return}var g={action:"tve_display_widget",security:tve_path_params.tve_ajax_nonce,options:this.config.get().options,widget:this.config.get().widget};TVE_Editor_Page.overlay();jQuery.post(tve_path_params.ajax_url,g,function(h){jQuery(".tve_widget_container",d.wrapper).html(h);d.wrapper.removeClass("code_placeholder");d.wrapper.find("#lb_widgets").remove();TVE_Editor_Page.overlay("close")})}};if(!this.find(".tve_widgets_list").length){return f}jQuery(".tve_widgets_list").change(function(){a(jQuery(this).val(),new Array())}).val(b.get().widget);e(b.get().widget);function a(j,g){if(!j.length){d.optionsContianer.html("");TVE_Editor_Page.overlay("close");return}var h={action:"tve_widget_options",widget:j,security:tve_path_params.tve_ajax_nonce,options:g};TVE_Editor_Page.overlay();jQuery.post(tve_path_params.ajax_url,h,function(k){d.optionsContianer.html(k);TVE_Editor_Page.overlay("close")})}function e(h){var g={action:"tve_widgets_list",security:tve_path_params.tve_ajax_nonce};TVE_Editor_Page.overlay();jQuery.post(tve_path_params.ajax_url,g,function(j){jQuery(".tve_widgets_list").append(j);jQuery(".tve_widgets_list").val(h);a(h,b.get().options)})}return this},tve_lightbox:function(){var a=this.is(".tve_p_lb_content")?this:this.parents(".tve_p_lb_content").first();return{setBgPattern:function(b){this.clearBgImage().clearBgColor().set_option("l_cpat",b);a.css({"background-image":"url('"+b+"')","background-repeat":"repeat"})},setBgImage:function(b){this.clearBgImage().set_option("l_cimg",b.url);a.css({"background-image":"url('"+b.url+"')","background-repeat":"","background-size":"cover"})},clearBgImage:function(){this.set_option("l_cimg","");a.css({"background-image":"","background-repeat":"","background-size":""});return this},clearBgPattern:function(){this.set_option("l_ccls","").set_option("l_cpat","");a.css({"background-image":"","background-repeat":"","background-size":""});return this},clearBgColor:function(){this.set_option("l_ccls","");if(a.tve_color_selector()){tve_remove_css_rule(a.tve_color_selector(),"background-color")}a.css("background-color","");return this},set_option:function(c,b){tve_path_params.tve_globals[c]=b;return this}}},tve_lp:function(){var a=this;if(this.hasClass("tve_wrap_all")){a=this.parents("body")}return{setBgPattern:function(b){this.clearBgImage().clearBgColor().set_option("lp_bgp",b);a.css({"background-image":"url('"+b+"')","background-repeat":"repeat","background-size":"auto",height:""})},setBgImage:function(b){this.clearBgPattern();this.set_option("lp_bgi",b.url);a.css({"background-image":"url('"+b.url+"')","background-repeat":"no-repeat","background-size":"cover"}).attr({"data-width":b.width,"data-height":b.height});if(a.hasClass("tve_fh")){this.bgCover(true)}},clearBgImage:function(){this.set_option("lp_bgi","none");a.css({"background-image":"none","background-repeat":"",height:""});return this},clearBgPattern:function(){this.set_option("lp_bgp","");this.set_option("lp_bgi","none");a.css({"background-image":"none","background-repeat":""});return this},clearBgColor:function(){this.set_option("lp_bg","#ffffff");if(a.tve_color_selector()){tve_remove_css_rule(a.tve_color_selector(),"background-color")}a.css("background-color","#ffffff");return this},bgAttachment:function(b){a.css("background-attachment",b?"fixed":"scroll");this.set_option("lp_bga",b?"fixed":"scroll")},bgCover:function(e){a.css("height","").removeClass("tve_fh");if(a.hasClass("tve_lp_content")&&e){var d=parseInt(a.attr("data-width")),c=parseInt(a.attr("data-height")),b=a.outerWidth(),f="";if(isNaN(d)||isNaN(c)){return}if(b<d){var g=d/c;f=parseInt(b/g)}else{f=c}a.css({height:f+"px"}).addClass("tve_fh")}},set_option:function(c,b){if(a.is("body")){tve_path_params.tve_globals[c]=b}return this}}},tve_post_grid:function(c){var d=jQuery.extend({},c);var a=this;if(a.find(".thrive-shortcode-config").length){var b=TVE_Editor_Page.thriveShrtcodeConfig(a.find(".thrive-shortcode-config"),"post_grid")}return{sortable:function(){a.find(".tve_sortable_layout").sortable();return this},autocomplete:function(){var f={security:tve_path_params.tve_ajax_nonce};function e(h){return h.split(/,\s*/)}function g(h){return e(h).pop()}a.find(".tve_post_grid_autocomplete").autocomplete({source:function(j,h){f.term=g(j.term);jQuery.ajax({url:TVE_Content_Builder.config.ajax_url,dataType:"json",type:"post",data:f,success:function(k){h(k)},error:function(){}})},focus:function(){return false},search:function(h,j){f.action=jQuery(this).data("action")},select:function(j,k){var h=e(this.value);h.pop();h.push(k.item.value);h.push("");this.value=h.join(",");return false}});return this},display:function(){var e=d,f=this;e.security=tve_path_params.tve_ajax_nonce;e.action="tve_do_post_grid_shortcode";e.exclude=TVE_Content_Builder.config.post_id;TVE_Editor_Page.overlay();jQuery.ajax({url:TVE_Content_Builder.config.ajax_url,type:"post",data:e,success:function(g){a.removeClass("image_placeholder");TVE_Editor_Page.overlay("close");$newElement=TVE_Content_Builder.drag.insert(g,a,false);clearFocus({forceExit:1});hide_control_panel_menu();$newElement.tve_post_grid().masonry()}});return this},masonry:function(){a.find(".tve_post_grid_masonry").masonry()},getConfig:function(){return b.get()}}}});