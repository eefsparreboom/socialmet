var TVE_Content_Builder=TVE_Content_Builder||{};(function(b){var a="tve_brdr_none tve_brdr_dotted tve_brdr_dashed tve_brdr_solid tve_brdr_double tve_brdr_groove tve_brdr_ridge tve_brdr_inset tve_brdr_outset";TVE_Content_Builder.controls={dropdown_menus:function(){var d=null,c={};b(".tve_option_separator").on("click",function(i){c.inner=true;var f=b(i.target),h=b(this),g=b("#tve_cpanel");if(f.is(".wp-color-picker, .tve_link, .tve_no_click")||f.parents(".tve_no_click").length){return true}i.preventDefault();b(".active_sub_menu").not(h.find(".active_sub_menu")).hide();if(f.hasClass("tve_click")||f.parents(".tve_click").length||!f.parents(".active_sub_menu").length){var j=h.find(".tve_sub");if(j.is(":visible")){j.hide().trigger("tve.hide_sub_menu").addClass("active_sub_menu");d=null}else{if(j.find(".tve_color_picker").length||j.find(".text_colour_picker").length){TVE_Content_Builder.colors.refresh()}j.show().addClass("active_sub_menu");d=h}tve_check_submenu_position(j);g.hasClass("tve_editor_collapse")&&g.addClass("expand_width")}if(!g.find(".tve_sub :visible").length){g.removeClass("expand_width")}});b(document).on("click.remove_submenu",function(g){if(c.inner){c.inner=false;return}if(!d){return}var f=b(g.target);if(f.closest(".tve_oparator").first().is(d)){return}hide_sub_menu();b("#tve_cpanel").removeClass("expand_width")})},prevent_default:function(d,c,f){f.preventDefault()},rangy_cls:function(f,d,h,g){h.preventDefault();var c={bold_text:rangy.createCssClassApplier("bold_text",{normalize:true}),italic_text:rangy.createCssClassApplier("italic_text",{normalize:true}),underline_text:rangy.createCssClassApplier("underline_text",{normalize:false}),strikethrough_text:rangy.createCssClassApplier("strikethrough_text",{normalize:false})};if(typeof g==="undefined"){g=f.attr("data-command")+"_text"}c[g].toggleSelection()},save_selection:function(c){window[c.attr("data-key")]=rangy.saveSelection()},text_unlink:function(f,d,g){var c=b(".tve_active_hyperlink");c.replaceWith(c.html());tve_hide_hyperlink_options()},lb_close:function(c){b("#tve_lightbox_overlay, #tve_lightbox_frame").hide();b(".tve_active_lightbox").removeClass("tve_active_lightbox");if(c&&c.hasClass("tve_mce_close")){tve_hide_tinymce_popup()}},lb_open:function(d,c,f){f.preventDefault();f.stopPropagation();if(d.hasClass("tve_btn")){c.closest(".thrv_wrapper").addClass("tve_active_lightbox")}else{d.closest(".thrv_wrapper").addClass("tve_active_lightbox")}tve_open_lightbox(d)},lb_save:function(d){var c=d.hasClass("tve_mce_save")?{tve_lb_type:"shortcode"}:tve_get_lightbox_options();if(tve_handle_lightbox_options(c)){TVE_Content_Builder.controls.lb_close()}},set_global_flag:function(c){tve_path_params.tve_globals[c.attr("data-flag")]=(c.is(":checked")?c.val():0)},click:{css:function(d,c){if(d.attr("data-elem")){c=c.find(d.attr("data-elem"))}c.css(d.attr("data-prop"),d.attr("data-val"))},text_align:function(d,c){if(c.is(".tve_ct_title")){c=c.parents(".thrv_contents_table")}else{if(c.is(".thrv_tw_qs_button_text")){c=c.parents(".thrv_tw_qs_button")}}c.removeClass("tve_p_left tve_p_right tve_p_center tvealignjustify").addClass(d.attr("data-cls"))},block_change:function(g,d,h){var f=g.attr("data-tag"),c=b("<"+f+" class='edit_mode'>"+d.html()+"</"+f+">");d.replaceWith(c);TVE_Content_Builder.drag.bind_draggable(c);h.target=d;convert_element_into_edit_mode(b(".edit_mode"),h);tve_set_selected_dropdown(g)},more_link:function(d,c){b(".tve_more_tag").remove();var e=b('<p class="tve_more_tag"><span class="tve_no_edit">More...</span></p>');b(c).after(e);TVE_Content_Builder.drag.after_clone(c,e)},image_unlink:function(d,c,f){b(c).parents("a").replaceWith(c);d.parent().hide()},add_class:function(f,d,g){var c=f.attr("data-cls")?f.attr("data-cls"):f.attr("id");switch(f.data("type")){case"button":if(f.attr("data-size")){d.removeClass("tve_smallBtn tve_normalBtn tve_bigBtn tve_hugeBtn")}else{d.removeClass("tve_btn1 tve_btn2 tve_btn3 tve_btn4 tve_btn5 tve_btn6 tve_btn7 tve_btn8")}d.find("i").css("width","").css("font-size","");break;case"table_cell":tve_event_change(b("input#table_inner_border").prop("checked",true),d.parents(".thrv_table").first(),"table");break;case"lightbox":d=d.add(d.find(".tve_p_lb_close"));tve_path_params.tve_globals.l_cbs=c;break;case"bullets":d.removeClass("tve_ul1 tve_ul2 tve_ul3 tve_ul4 tve_ul5 tve_ul6");break;case"feature_grid":d.removeClass("tve_gr1 tve_gr2 tve_gr3");break;case"contentbox":d.removeClass("tve_sb_bot");break;case"icon":d=d.parent();break}if(f.attr("data-border")){d.removeClass(a)}d.addClass(c);tve_set_selected_dropdown(f);return false},lead_generation_style:function(d,c){c.tve_lead_generation().applyStyle(d.attr("id"));return false},style_family:function(c){hide_sub_menu();tve_change_style_family(c.text());tve_set_selected_dropdown(c)},remove_user_template:function(c){if(!confirm("Are you sure you want to remove this Content Template? This action cannot be undone")){return true}var d={action:"tve_remove_user_template",template_name:encodeURIComponent(b.trim(c.parent().find(".tve_left").text())),security:tve_path_params.tve_ajax_nonce};jQuery.post(tve_path_params.ajax_url,d,function(){c.parent().remove();if(c.parent().find("li.cp_draggable").length===0){c.parent().find("li.hide-on-tpl-save").show()}tve_add_notification("Template deleted!")});return true},change_pattern:function(e){var c=e.attr("data-pattern")?true:false,d=e.find("input").attr(c?"data-image":"id"),f=e.attr("data-plugin");if(c){b(".edit_mode")[f]().setBgPattern(d)}else{b(".edit_mode")[f]().setBgColor(d)}return false},add_toggle:function(e,c){var d=c.find(".tve_faq").first().html();b(c).append("<div class='tve_faq active_toggle'></div>");b(".active_toggle").html(d).removeClass("active_toggle")},collapse_editor:function(){b("#tve_cpanel,body").toggleClass("tve_editor_collapse");b(".tve_wrap_inner").toggleClass("tve_is_collapsed");hide_sub_menu()},flip_editor:function(){tve_menu_position(b("#tve_cpanel").hasClass("tve_cpanelFlip")?"right":"left")},flip_editor_color:function(){tve_menu_color(b("#tve_cpanel").hasClass("tve_is_dark")?"light":"dark")}},change:{element_id:function(d,c){c.attr("id",d.val())},link_url:function(d,c){c.find("a.tve_btnLink").attr("href",d.val());if(b(".cta_test_link:visible").length){b(".cta_test_link").attr("href",d.val())}b(".tve_active_hyperlink").attr("href",d.val())},link_text:function(d,c){if(d.data("type")=="button"){if(c.find("a .tve_btn_txt, a .tve_btn_text").length){c.find("a .tve_btn_txt, a .tve_btn_text").last().text(d.val())}else{c.find("a").contents().last()[0].textContent=d.val()}}else{b(".tve_active_hyperlink").text(d.val())}},link_target:function(e,d){var c=e.is(":checked")?"_blank":"_self";d.find("a.tve_btnLink").attr("target",c);b(".tve_active_hyperlink").attr("target",c)},link_rel:function(e,d){var c=e.is(":checked")?e.attr("data-value"):"";d.find("a.tve_btnLink").attr("rel",c);b(".tve_active_hyperlink").attr("rel",c)},cls:function(d){var c=b(".edit_mode");c.removeClass(function(f,h){var g="";h=h.split(" ");for(var f=0,e;e=h[f++];){if(e.indexOf("thrv_")===-1&&e.indexOf("tve_")===-1&&thrv_custom_classes.indexOf(e)===-1&&custom_font_classes.indexOf(e)===-1){g+=(g?" ":"")+e}}return g});c.addClass(d.val())},cc:function(d,c){c.find(".tve_"+d.attr("id")).css("display",d.is(":checked")?"block":"none")},cc_in_btn:function(d,c){if(d.prop("checked")){jQuery.post(tve_path_params.shortcodes_dir+"sc_cc_icons.php",{colour:window.last_colour_used,cssdir:tve_path_params.editor_dir},function(e){c.after(e)})}else{c.parent().find(".thrv_cc_icons").remove()}},translate:function(f,h,c,g){var d=h.val();c.find(f).text(d.length?d:h.attr("placeholder"))},icon_text:function(d,c){c.text(d.val())}},mousedown:{test_image:function(d,c,f){f.preventDefault();hide_control_panel_menu();thrive_open_media(d,"load","testimonial_button",c)}},text:{remove_color:function(e,c){var h=e.attr("data-mode"),f=rangy.getSelection(),d=h=="background"?"backgroundColor":"color",g=h=="background"?"BackColor":"ForeColor";if(!f.toString().length){c.find("font").contents().unwrap();c.css(d,"")}else{document.execCommand("removeFormat",false,g);f.removeAllRanges()}}},pricing_table:{move:function(e,c){var d=c.find(".tve_hgh");if(d.length===0){return}var f=d[e.attr("data-dir")](".tve_prt_col").addClass("tve_hgh");if(f.length){d.removeClass("tve_hgh")}},highlight_toggle:function(e,c){var d=c.find(".tve_hgh").first();if(d.length===0){c.find(".tve_prt_col").first().addClass("tve_hgh");d=1}else{d.removeClass("tve_hgh");d=0}this.highlight_btn(e,c,d)},highlight_btn:function(e,d,c){if(typeof c==="undefined"){c=d.find(".tve_hgh").length}e.text(c?"Remove highlighted column":"Add highlighted column")}},thrive_optin:{option:function(d,c){c.tve_thrive_optin()[d.attr("data-fn")](d.attr("data-value"));return false}},shadow:{blur:{inset_small:9,inset_medium:20,inset_large:50,small:2,medium:7,large:20},spread:{inset_small:-2,inset_medium:-5,inset_large:-15,small:0,medium:-2,large:-5},offset_matrix:{inset_small:7,inset_medium:20,inset_large:50,small:1,medium:7,large:20},position_matrix:{"inset_top-left":[1,1],inset_top:[0,1],"inset_top-right":[-1,1],inset_left:[1,0],inset_center:[0,0],inset_right:[-1,0],"inset_bottom-left":[1,-1],inset_bottom:[0,-1],"inset_bottom-right":[-1,-1],"top-left":[-1,-1],top:[0,-1],"top-right":[1,-1],left:[-1,0],center:[0,0],right:[1,0],"bottom-left":[-1,1],bottom:[0,1],"bottom-right":[1,1]},defaults:{i:{x:10,y:10,b:8,c:"rgba(0,0,0,0.7)",p:"inset_center"},o:{x:7,y:7,b:7,c:"rgba(0,0,0,0.7)",p:"center"}},current_element:null,$sliders:b(),on_menu_show:function(e,c){if(e.find(".tve_shadow_control").length===0){return}this.$sliders=e.find(".tve_slider_shadow");this.current_element=this.get_element(c,e.attr("id").replace("_menu",""));if(!this.current_element.data("shadow")&&this.current_element.css("box-shadow")&&this.current_element.css("box-shadow")!=="none"){this.try_load_settings(this.current_element)}var d=this.get_config(c,null);d&&d.i&&this.update_slider(true,d.i);d&&d.o&&this.update_slider(false,d.o)},get_element:function(c,e){var h=tve_get_shortcode_wrapper_click(c),g=TVE_Content_Builder.colors.get_color_settings(e,h);if(!g){return c}for(var d=0,f;f=g[d++];){if(f.value==="box-shadow-all"){return h.find(f.selector)}}return c},get_item_declaration:function(c){var e=c.p.indexOf("inset")!==-1,d=e?"inset ":"";d+=parseInt(c.x*this.position_matrix[c.p][0])+"px";d+=" "+parseInt(c.y*this.position_matrix[c.p][1])+"px";d+=" "+c.b+"px";if(c.p.indexOf("center")!==-1){d+=" "+parseInt(c.b/2)+"px"}else{d+=" -"+parseInt(c.b/4)+"px"}return d+" "+c.c},position:function(h,d){var c=h.attr("data-coords"),e=c.indexOf("inset")!==-1,f=this.get_config(this.current_element,e),g=e?"i":"o";f[g].p=c;if(f[g].c=="transparent"){f[g].c=this.defaults[g].c}this.update_slider(e,f[g]);this.apply(f,this.current_element)},size:function(i,d){var f=i.attr("data-size"),e=i.attr("data-inset")?true:false,g=this.get_config(this.current_element,e),h=e?"i":"o",c=(e?"inset_":"")+f;g[h].x=this.offset_matrix[c];g[h].y=this.offset_matrix[c];g[h].b=this.blur[c];if(g[h].c=="transparent"){g[h].c=this.defaults[h].c}this.update_slider(e,g[h]);this.apply(g,this.current_element)},update_slider:function(d,e){var c=!e.x?!e.y?e.b*2:e.y*2:e.x*2;this.$sliders.filter(d?".tve_inset":".tve_outer").slider("value",c)},apply:function(e,d){var g=b.extend(true,{},e);this.current_element.data("shadow",g);var f=this.get_css_values(e),c=tve_get_unique_css_identifier(d,true);f=replaceAll("[css_values]",f,TVE_Content_Builder.colors.css_props["box-shadow-all"]);b.when(tve_remove_css_rule(c,"-webkit-box-shadow"),tve_remove_css_rule(c,"-moz-box-shadow"),tve_remove_css_rule(c,"box-shadow")).then(tve_add_css_rule('[data-tve-custom-colour="'+c+'"]',f,0))},get_config:function(c,d){var e=b.extend(true,{},c.data("shadow"));if(d!==null){var f=d?"i":"o";if(!e||!e[f]){e=e||{};e[f]=b.extend({},this.defaults[f]);e[f].c=TVE_Content_Builder.colors.parse_box_shadow(c,{inset:d}).found_color[0];if(e[f].c=="transparent"){e[f].c=this.defaults[f].c}c.data("shadow",e)}}return e},clear:function(f,c){var d=f.attr("data-inset")?true:false,e=this.get_config(this.current_element,d);delete e[d?"i":"o"];this.apply(e,this.current_element)},color_changed:function(d,c){var e=this.get_config(this.current_element,c);e[c?"i":"o"].c=d;this.current_element.data("shadow",b.extend(true,{},e));return e},inset_slider:function(c,f){var d=parseInt(f),e=this.get_config(this.current_element,true);e.i.x=parseInt(d/2);e.i.y=parseInt(d/2);e.i.b=parseInt(d/2);this.apply(e,this.current_element)},outset_slider:function(c,f){var d=parseInt(f),e=this.get_config(this.current_element,false);e.o.x=parseInt(d/2);e.o.y=parseInt(d/2);e.o.b=parseInt(d/2);this.apply(e,this.current_element)},get_css_values:function(c){var d="";if(c.i){d+=this.get_item_declaration(c.i)}if(c.o){d+=(d?",":"")+this.get_item_declaration(c.o)}return d},try_load_settings:function(d){var f=TVE_Content_Builder.colors.parse_box_shadow(d),e={};if(f.css_rules.i&&f.colors.i){var c=this.parse_shadow_size(f.css_rules.i,"inset_");if(c!==false){e.i=c;e.i.c=f.colors.i}}if(f.css_rules.o&&f.colors.o){var c=this.parse_shadow_size(f.css_rules.o,"");if(c!==false){e.o=c;e.o.c=f.colors.o}}this.current_element.data("shadow",b.extend({},true,e))},parse_shadow_size:function(e,c){var g=e.split(" "),d=[],f={};b.each(g,function(k,j){var h=parseInt(b.trim(j));if(!isNaN(h)){d.push(h)}});if(d.length<2){return false}if(d[0]===0&&d[1]===0){f.p=c+"center"}else{b.each(this.position_matrix,function(h,i){if(tve_signum(i[0])===tve_signum(d[0])&&tve_signum(i[1])===tve_signum(d[1])){if(c&&h.indexOf("inset")===0){f.p=h;return false}if(!c&&h.indexOf("inset")===-1){f.p=h;return false}}})}if(!f.p){return false}if(!d[2]){d[2]=0}f.x=Math.abs(d[0]);f.y=Math.abs(d[1]);f.b=d[2];return f}}}})(jQuery);